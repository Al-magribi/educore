import{I as e,k as a,F as s,K as t,Y as n,Z as i,o as r,C as l,x as o,p as c,w as m,R as d,q as h,z as u,y as x,T as p,_ as j,$ as f,s as y,A as g,X as b,M as _,B as S,N as k,P as v,Q as w}from"./index-DJgzJvx0.js";import{r as I}from"./vendor-kOq7Q5-U.js";import{I as C}from"./InfiniteScrollList-CRQVFRuq.js";import{S as P}from"./index-ZAZRIL-n.js";import{R as T}from"./PhoneOutlined-B9xyKFne.js";import{S as N}from"./index-l_qaOEJz.js";import{M as B}from"./index-CWRbA1GH.js";import{D as z}from"./index-Ddh-PgSR.js";import{T as F}from"./index-A8UrXWNV.js";import{P as M}from"./index-C1pdE3N8.js";import{R as L}from"./DeleteOutlined-B97TiFIe.js";import"./charts-4CCI6hAs.js";import"./index-CsPvpU6M.js";import"./index-BzygXUWO.js";import"./ActionButton-DZkZ4UyV.js";import"./context-Co2t6AGx.js";import"./useMergedMask-hWGqm8nf.js";import"./useClosable-BMlLLbW6.js";var O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-260 72h96v209.9L621.5 312 572 347.4V136zm220 752H232V136h280v296.9c0 3.3 1 6.6 3 9.3a15.9 15.9 0 0022.3 3.7l83.8-59.9 81.4 59.4c2.7 2 6 3.1 9.4 3.1 8.8 0 16-7.2 16-16V136h64v752z"}}]},name:"book",theme:"outlined"};function A(){return A=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=s[t])}return e},A.apply(this,arguments)}const D=(a,s)=>I.createElement(e,A({},a,{ref:s,icon:O})),E=I.forwardRef(D),{Option:G}=P,H=e=>{const p=a.c(58),{open:j,onCancel:f,onSuccess:y,initialData:g}=e,[b]=s.useForm();let _;p[0]===Symbol.for("react.memo_cache_sentinel")?(_={page:1,limit:100},p[0]=_):_=p[0];const{data:S,isLoading:k}=t(_),[v,w]=n(),{isLoading:C}=w,[F,M]=i(),{isLoading:L}=M;let O,A,D;p[1]!==b||p[2]!==g||p[3]!==j?(O=()=>{j&&(g?b.setFieldsValue({...g,password:"",homebase_id:g.homebase_id||void 0}):b.resetFields())},A=[j,g,b],p[1]=b,p[2]=g,p[3]=j,p[4]=O,p[5]=A):(O=p[4],A=p[5]),I.useEffect(O,A),p[6]!==v||p[7]!==b||p[8]!==g||p[9]!==y||p[10]!==F?(D=async e=>{try{g?(await F({id:g.id,...e}).unwrap(),u.success("Data guru diperbarui")):(await v(e).unwrap(),u.success("Guru berhasil ditambahkan")),b.resetFields(),y()}catch(a){const e=a;u.error(e?.data?.message||"Terjadi kesalahan")}},p[6]=v,p[7]=b,p[8]=g,p[9]=y,p[10]=F,p[11]=D):D=p[11];const E=D,G=g?"Edit Data Guru":"Tambah Guru Baru",H=C||L;let K,V,R,W;p[12]===Symbol.for("react.memo_cache_sentinel")?(K=r.jsx(z,{orientation:"left",style:{margin:"0 0 16px 0"},children:"Informasi Akun"}),p[12]=K):K=p[12],p[13]===Symbol.for("react.memo_cache_sentinel")?(V=[{required:!0,message:"Nama wajib diisi"}],p[13]=V):V=p[13],p[14]===Symbol.for("react.memo_cache_sentinel")?(R=r.jsx(l,{span:12,children:r.jsx(s.Item,{name:"full_name",label:"Nama Lengkap (dengan gelar)",rules:V,children:r.jsx(o,{placeholder:"Contoh: Budi Santoso, S.Pd.",prefix:r.jsx(c,{})})})}),p[14]=R):R=p[14],p[15]===Symbol.for("react.memo_cache_sentinel")?(W=[{required:!0,message:"Username wajib diisi"}],p[15]=W):W=p[15];const U=!!g;let Y;p[16]!==U?(Y=r.jsxs(m,{gutter:16,children:[R,r.jsx(l,{span:12,children:r.jsx(s.Item,{name:"username",label:"Username Login",rules:W,children:r.jsx(o,{placeholder:"Username unik",disabled:U})})})]}),p[16]=U,p[17]=Y):Y=p[17];const J=g?"Password Baru (Opsional)":"Password",Q=!g;let X,Z,$,ee;p[18]!==Q?(X={required:Q,message:"Password wajib diisi"},p[18]=Q,p[19]=X):X=p[19],p[20]===Symbol.for("react.memo_cache_sentinel")?(Z={min:6,message:"Minimal 6 karakter"},p[20]=Z):Z=p[20],p[21]!==X?($=[X,Z],p[21]=X,p[22]=$):$=p[22],p[23]===Symbol.for("react.memo_cache_sentinel")?(ee=r.jsx(x,{}),p[23]=ee):ee=p[23];const ae=g?"Biarkan kosong jika tidak diubah":"Password akun";let se,te,ne,ie,re,le,oe,ce,me,de,he,ue,xe;return p[24]!==ae?(se=r.jsx(o.Password,{prefix:ee,placeholder:ae}),p[24]=ae,p[25]=se):se=p[25],p[26]!==J||p[27]!==$||p[28]!==se?(te=r.jsx(s.Item,{name:"password",label:J,rules:$,children:se}),p[26]=J,p[27]=$,p[28]=se,p[29]=te):te=p[29],p[30]===Symbol.for("react.memo_cache_sentinel")?(ne=r.jsx(z,{orientation:"left",style:{margin:"10px 0 16px 0"},children:"Data Kepegawaian"}),p[30]=ne):ne=p[30],p[31]===Symbol.for("react.memo_cache_sentinel")?(ie=[{required:!0,message:"Guru wajib memiliki Homebase"}],p[31]=ie):ie=p[31],p[32]!==S?.data?(re=S?.data?.map(q),p[32]=S?.data,p[33]=re):re=p[33],p[34]!==k||p[35]!==re?(le=r.jsx(l,{span:12,children:r.jsx(s.Item,{name:"homebase_id",label:"Penempatan (Homebase)",rules:ie,children:r.jsx(P,{placeholder:"Pilih Satuan Pendidikan",loading:k,showSearch:!0,optionFilterProp:"children",children:re})})}),p[34]=k,p[35]=re,p[36]=le):le=p[36],p[37]===Symbol.for("react.memo_cache_sentinel")?(oe=r.jsx(l,{span:12,children:r.jsx(s.Item,{name:"nip",label:"NIP / NIY",children:r.jsx(o,{placeholder:"Nomor Induk",prefix:r.jsx(d,{})})})}),p[37]=oe):oe=p[37],p[38]!==le?(ce=r.jsxs(m,{gutter:16,children:[le,oe]}),p[38]=le,p[39]=ce):ce=p[39],p[40]===Symbol.for("react.memo_cache_sentinel")?(me=r.jsx(l,{span:12,children:r.jsx(s.Item,{name:"phone",label:"No. Telepon / WhatsApp",children:r.jsx(o,{placeholder:"08xxx",prefix:r.jsx(T,{})})})}),p[40]=me):me=p[40],p[41]===Symbol.for("react.memo_cache_sentinel")?(de=r.jsxs(m,{gutter:16,children:[me,r.jsx(l,{span:12,children:r.jsx(s.Item,{name:"email",label:"Email",children:r.jsx(o,{type:"email",placeholder:"email@sekolah.sch.id",prefix:r.jsx(h,{})})})})]}),p[41]=de):de=p[41],p[42]!==g?(he=g&&r.jsx(s.Item,{name:"is_active",label:"Status Akun",valuePropName:"checked",children:r.jsx(N,{checkedChildren:"Aktif",unCheckedChildren:"Nonaktif"})}),p[42]=g,p[43]=he):he=p[43],p[44]!==b||p[45]!==E||p[46]!==Y||p[47]!==te||p[48]!==ce||p[49]!==he?(ue=r.jsxs(s,{form:b,layout:"vertical",onFinish:E,children:[K,Y,te,ne,ce,de,he]}),p[44]=b,p[45]=E,p[46]=Y,p[47]=te,p[48]=ce,p[49]=he,p[50]=ue):ue=p[50],p[51]!==b.submit||p[52]!==f||p[53]!==j||p[54]!==ue||p[55]!==G||p[56]!==H?(xe=r.jsx(B,{title:G,open:j,onCancel:f,onOk:b.submit,confirmLoading:H,destroyOnHidden:!0,width:700,children:ue}),p[51]=b.submit,p[52]=f,p[53]=j,p[54]=ue,p[55]=G,p[56]=H,p[57]=xe):xe=p[57],xe};function q(e){return r.jsx(G,{value:e.id,children:e.name},e.id)}const{Title:K,Text:V}=p,R=()=>{const e=a.c(42),[s,t]=I.useState(1),[n,i]=I.useState("");let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=[],e[0]=l):l=e[0];const[m,d]=I.useState(l),[h,x]=I.useState(!1),[p,P]=I.useState(null),T=((e,s)=>{const t=a.c(4),[n,i]=I.useState(e);let r,l;return t[0]!==s||t[1]!==e?(r=()=>{const a=setTimeout(()=>{i(e)},s);return()=>{clearTimeout(a)}},l=[e,s],t[0]=s,t[1]=e,t[2]=r,t[3]=l):(r=t[2],l=t[3]),I.useEffect(r,l),n})(n,500);let N;e[1]!==T||e[2]!==s?(N={page:s,limit:16,search:T},e[1]=T,e[2]=s,e[3]=N):N=e[3];const{data:B,isFetching:z,refetch:O}=j(N),[A,D]=f(),{isLoading:G}=D;let q,R,U,Y,J;e[4]!==B||e[5]!==s?(q=()=>{B?.data&&d(1===s?B.data:e=>{const a=B.data.filter(a=>!e.some(e=>e.id===a.id));return[...e,...a]})},R=[B,s],e[4]=B,e[5]=s,e[6]=q,e[7]=R):(q=e[6],R=e[7]),I.useEffect(q,R),e[8]===Symbol.for("react.memo_cache_sentinel")?(U=()=>{t(1)},e[8]=U):U=e[8],e[9]!==n?(Y=[n],e[9]=n,e[10]=Y):Y=e[10],I.useEffect(U,Y),e[11]!==B?.hasMore||e[12]!==z?(J=()=>{B?.hasMore&&!z&&t(W)},e[11]=B?.hasMore,e[12]=z,e[13]=J):J=e[13];const Q=J;let X;e[14]===Symbol.for("react.memo_cache_sentinel")?(X=e=>{P(void 0===e?null:e),x(!0)},e[14]=X):X=e[14];const Z=X;let $;e[15]!==A||e[16]!==O?($=async e=>{try{await A(e).unwrap(),u.success("Guru berhasil dihapus"),t(1),O()}catch(a){u.error("Gagal menghapus data")}},e[15]=A,e[16]=O,e[17]=$):$=e[17];const ee=$;let ae;e[18]!==O?(ae=()=>{x(!1),P(null),t(1),O()},e[18]=O,e[19]=ae):ae=e[19];const se=ae;let te;e[20]!==ee||e[21]!==G?(te=e=>r.jsx(y,{hoverable:!0,style:{height:"100%"},bodyStyle:{padding:"16px"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[r.jsxs("div",{style:{display:"flex",gap:12,flex:1,minWidth:0},children:[r.jsx(g,{size:48,src:e.img_url,icon:r.jsx(c,{}),shape:"circle",style:{backgroundColor:"#87d068",flexShrink:0}}),r.jsxs("div",{style:{minWidth:0,flex:1},children:[r.jsx(K,{level:5,style:{margin:0,fontSize:15},ellipsis:!0,children:e.full_name}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,marginTop:2},children:[r.jsxs(V,{type:"secondary",style:{fontSize:12},children:["@",e.username]}),r.jsx("span",{style:{color:"#ddd"},children:"|"}),r.jsx(V,{type:"secondary",style:{fontSize:12},children:e.nip||"Non-NIP"})]}),r.jsxs("div",{style:{marginTop:8},children:[r.jsx(F,{icon:r.jsx(E,{}),color:"cyan",style:{marginBottom:4},children:e.homebase_name||"Belum ada Homebase"}),r.jsx(F,{color:e.is_active?"success":"error",children:e.is_active?"AKTIF":"NONAKTIF"})]}),r.jsxs(V,{type:"secondary",style:{fontSize:11,display:"block",marginTop:4,color:"#aaa"},children:[e.email||"—"," • ",e.phone||"—"]})]})]}),r.jsxs(b,{direction:"vertical",size:0,children:[r.jsx(_,{title:"Edit",children:r.jsx(S,{type:"text",size:"small",icon:r.jsx(k,{style:{color:"orange"}}),onClick:()=>Z(e)})}),r.jsx(M,{title:"Hapus Guru?",description:"Data mengajar, nilai, dan absensi terkait mungkin akan hilang.",onConfirm:()=>ee(e.id),okText:"Ya, Hapus",cancelText:"Batal",children:r.jsx(S,{type:"text",size:"small",danger:!0,icon:r.jsx(L,{}),loading:G})})]})]})}),e[20]=ee,e[21]=G,e[22]=te):te=e[22];const ne=te;let ie,re,le,oe;e[23]===Symbol.for("react.memo_cache_sentinel")?(ie={display:"flex",justifyContent:"space-between",marginBottom:16,gap:10},e[23]=ie):ie=e[23],e[24]===Symbol.for("react.memo_cache_sentinel")?(re=r.jsx(v,{}),e[24]=re):re=e[24],e[25]===Symbol.for("react.memo_cache_sentinel")?(le=r.jsx(o,{placeholder:"Cari nama atau NIP...",prefix:re,allowClear:!0,onChange:e=>i(e.target.value),style:{maxWidth:300}}),e[25]=le):le=e[25],e[26]===Symbol.for("react.memo_cache_sentinel")?(oe=r.jsxs("div",{style:ie,children:[le,r.jsx(S,{type:"primary",icon:r.jsx(w,{}),onClick:()=>Z(null),children:"Tambah Guru"})]}),e[26]=oe):oe=e[26];const ce=B?.hasMore;let me,de,he,ue,xe;return e[27]===Symbol.for("react.memo_cache_sentinel")?(me={gutter:[16,16],xs:24,sm:24,md:12,lg:8,xl:6,xxl:6},e[27]=me):me=e[27],e[28]!==Q||e[29]!==z||e[30]!==m||e[31]!==ne||e[32]!==ce?(de=r.jsx(C,{data:m,loading:z,hasMore:ce,onLoadMore:Q,renderItem:ne,height:"75vh",emptyText:"Belum ada data guru",grid:me}),e[28]=Q,e[29]=z,e[30]=m,e[31]=ne,e[32]=ce,e[33]=de):de=e[33],e[34]===Symbol.for("react.memo_cache_sentinel")?(he=()=>x(!1),e[34]=he):he=e[34],e[35]!==p||e[36]!==se||e[37]!==h?(ue=r.jsx(H,{open:h,initialData:p,onCancel:he,onSuccess:se}),e[35]=p,e[36]=se,e[37]=h,e[38]=ue):ue=e[38],e[39]!==de||e[40]!==ue?(xe=r.jsxs(r.Fragment,{children:[oe,de,ue]}),e[39]=de,e[40]=ue,e[41]=xe):xe=e[41],xe};function W(e){return e+1}const U=()=>{const e=a.c(1);let s;return e[0]===Symbol.for("react.memo_cache_sentinel")?(s=r.jsx(r.Fragment,{children:r.jsx(R,{})}),e[0]=s):s=e[0],s};export{U as default};
