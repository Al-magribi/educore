import{I as e,k as a,F as s,K as i,S as l,U as t,o as n,C as r,x as o,p as c,w as m,q as d,z as h,y as u,V as x,W as p,T as j,s as f,A as b,X as y,M as g,B as _,N as S,P as v,Q as k}from"./index-TxbSs64b.js";import{r as w}from"./vendor-kOq7Q5-U.js";import{I as C}from"./InfiniteScrollList-U1Ks4nZa.js";import{S as I}from"./index-B7bzky1V.js";import{R as P}from"./PhoneOutlined-1dKVFj2D.js";import{S as z}from"./index-CeAdYdI0.js";import{M as A}from"./index-BttLdxdX.js";import{T as L}from"./index-Dj0znD7j.js";import{P as T}from"./index-CFuv39oW.js";import{R as F}from"./DeleteOutlined-IFybz7Jy.js";import"./charts-DTgBacDZ.js";import"./index-CVJ5d8Nu.js";import"./index-Cv0kXVkw.js";import"./index-BZVnVTbm.js";import"./ActionButton-4PjL455O.js";import"./context-K0_FAUKW.js";import"./useClosable-y2z-qVwf.js";var M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M899.6 276.5L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.7-3.5-13.1 1.2-12.2 7.9L188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.8-6.7-6.5-11.4-12.3-7.9zM512 734.2c-62.1 0-112.6-50.5-112.6-112.6S449.9 509 512 509s112.6 50.5 112.6 112.6S574.1 734.2 512 734.2zm0-160.9c-26.6 0-48.2 21.6-48.2 48.3 0 26.6 21.6 48.3 48.2 48.3s48.2-21.6 48.2-48.3c0-26.6-21.6-48.3-48.2-48.3z"}}]},name:"crown",theme:"filled"};function O(){return O=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},O.apply(this,arguments)}const B=(a,s)=>w.createElement(e,O({},a,{ref:s,icon:M})),E=w.forwardRef(B),{Option:N}=I,W=e=>{const x=a.c(52),{open:p,onCancel:j,onSuccess:f,initialData:b}=e,[y]=s.useForm();let g;x[0]===Symbol.for("react.memo_cache_sentinel")?(g={page:1,limit:100},x[0]=g):g=x[0];const{data:_,isLoading:S}=i(g),[v,k]=l(),{isLoading:C}=k,[L,T]=t(),{isLoading:F}=T;let M,O,B;x[1]!==y||x[2]!==b||x[3]!==p?(M=()=>{p&&(b?y.setFieldsValue({...b,password:"",homebase_id:b.homebase_id||void 0}):y.resetFields())},O=[p,b,y],x[1]=y,x[2]=b,x[3]=p,x[4]=M,x[5]=O):(M=x[4],O=x[5]),w.useEffect(M,O),x[6]!==v||x[7]!==y||x[8]!==b||x[9]!==f||x[10]!==L?(B=async e=>{try{"satuan"!==e.level&&(e.homebase_id=null),b?(await L({id:b.id,...e}).unwrap(),h.success("Data admin diperbarui")):(await v(e).unwrap(),h.success("Admin baru ditambahkan")),y.resetFields(),f()}catch(a){const e=a;h.error(e?.data?.message||"Terjadi kesalahan")}},x[6]=v,x[7]=y,x[8]=b,x[9]=f,x[10]=L,x[11]=B):B=x[11];const E=B,W=b?"Edit Admin":"Tambah Admin Baru",H=C||F;let U,V,K;x[12]===Symbol.for("react.memo_cache_sentinel")?(U=[{required:!0,message:"Wajib diisi"}],x[12]=U):U=x[12],x[13]===Symbol.for("react.memo_cache_sentinel")?(V=n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"full_name",label:"Nama Lengkap",rules:U,children:n.jsx(o,{placeholder:"Nama Admin",prefix:n.jsx(c,{})})})}),x[13]=V):V=x[13],x[14]===Symbol.for("react.memo_cache_sentinel")?(K=[{required:!0,message:"Wajib diisi"}],x[14]=K):K=x[14];const R=!!b;let G,Q,X,Y,J,Z;x[15]!==R?(G=n.jsxs(m,{gutter:16,children:[V,n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"username",label:"Username",rules:K,children:n.jsx(o,{placeholder:"Username Login",disabled:R})})})]}),x[15]=R,x[16]=G):G=x[16],x[17]===Symbol.for("react.memo_cache_sentinel")?(Q=[{required:!0,message:"Pilih level akses"}],x[17]=Q):Q=x[17],x[18]===Symbol.for("react.memo_cache_sentinel")?(X=n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"level",label:"Level Akses",initialValue:"admin",rules:Q,children:n.jsxs(I,{placeholder:"Pilih Level",children:[n.jsx(N,{value:"pusat",children:"Pusat"}),n.jsx(N,{value:"satuan",children:"Satuan (Sekolah)"}),n.jsx(N,{value:"tahfiz",children:"Tahfiz"})]})})}),x[18]=X):X=x[18],x[19]===Symbol.for("react.memo_cache_sentinel")?(Y=n.jsxs(m,{gutter:16,children:[X,n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"phone",label:"No. Telepon",children:n.jsx(o,{placeholder:"08xxx",prefix:n.jsx(P,{})})})})]}),x[19]=Y):Y=x[19],x[20]!==_?.data||x[21]!==S?(J=n.jsx(s.Item,{noStyle:!0,shouldUpdate:q,children:e=>{const{getFieldValue:a}=e;return"satuan"===a("level")?n.jsx(s.Item,{name:"homebase_id",label:"Pilih Satuan Pendidikan (Homebase)",rules:[{required:!0,message:"Admin Satuan wajib memilih Homebase!"}],children:n.jsx(I,{placeholder:"Pilih Homebase",loading:S,allowClear:!0,showSearch:!0,optionFilterProp:"children",children:_?.data?.map(D)})}):null}}),x[20]=_?.data,x[21]=S,x[22]=J):J=x[22],x[23]===Symbol.for("react.memo_cache_sentinel")?(Z=n.jsx(s.Item,{name:"email",label:"Email",children:n.jsx(o,{placeholder:"email@sekolah.com",prefix:n.jsx(d,{})})}),x[23]=Z):Z=x[23];const $=b?"Password Baru (Opsional)":"Password",ee=!b;let ae,se,ie,le;x[24]!==ee?(ae={required:ee,message:"Password wajib diisi untuk admin baru"},x[24]=ee,x[25]=ae):ae=x[25],x[26]===Symbol.for("react.memo_cache_sentinel")?(se={min:6,message:"Minimal 6 karakter"},x[26]=se):se=x[26],x[27]!==ae?(ie=[ae,se],x[27]=ae,x[28]=ie):ie=x[28],x[29]===Symbol.for("react.memo_cache_sentinel")?(le=n.jsx(u,{}),x[29]=le):le=x[29];const te=b?"Isi jika ingin mengganti password":"Password akun";let ne,re,oe,ce,me;return x[30]!==te?(ne=n.jsx(o.Password,{prefix:le,placeholder:te}),x[30]=te,x[31]=ne):ne=x[31],x[32]!==$||x[33]!==ie||x[34]!==ne?(re=n.jsx(s.Item,{name:"password",label:$,rules:ie,children:ne}),x[32]=$,x[33]=ie,x[34]=ne,x[35]=re):re=x[35],x[36]!==b?(oe=b&&n.jsx(s.Item,{name:"is_active",label:"Status Akun",valuePropName:"checked",children:n.jsx(z,{checkedChildren:"Aktif",unCheckedChildren:"Nonaktif"})}),x[36]=b,x[37]=oe):oe=x[37],x[38]!==y||x[39]!==E||x[40]!==G||x[41]!==J||x[42]!==re||x[43]!==oe?(ce=n.jsxs(s,{form:y,layout:"vertical",onFinish:E,children:[G,Y,J,Z,re,oe]}),x[38]=y,x[39]=E,x[40]=G,x[41]=J,x[42]=re,x[43]=oe,x[44]=ce):ce=x[44],x[45]!==y.submit||x[46]!==j||x[47]!==p||x[48]!==ce||x[49]!==W||x[50]!==H?(me=n.jsx(A,{title:W,open:p,onCancel:j,onOk:y.submit,confirmLoading:H,destroyOnHidden:!0,width:600,children:ce}),x[45]=y.submit,x[46]=j,x[47]=p,x[48]=ce,x[49]=W,x[50]=H,x[51]=me):me=x[51],me};function q(e,a){return e.level!==a.level}function D(e){return n.jsx(N,{value:e.id,children:e.name},e.id)}const{Title:H,Text:U}=j,V=()=>{const e=a.c(42),[s,i]=w.useState(1),[l,t]=w.useState("");let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=[],e[0]=r):r=e[0];const[m,d]=w.useState(r),[u,j]=w.useState(!1),[I,P]=w.useState(null);let z;e[1]!==s||e[2]!==l?(z={page:s,limit:10,search:l},e[1]=s,e[2]=l,e[3]=z):z=e[3];const{data:A,isFetching:M,refetch:O}=x(z),[B,N]=p(),{isLoading:q}=N;let D,V,R,G,Q;e[4]!==A||e[5]!==s?(D=()=>{A?.data&&d(1===s?A.data:e=>{const a=A.data.filter(a=>!e.some(e=>e.id===a.id));return[...e,...a]})},V=[A,s],e[4]=A,e[5]=s,e[6]=D,e[7]=V):(D=e[6],V=e[7]),w.useEffect(D,V),e[8]===Symbol.for("react.memo_cache_sentinel")?(R=()=>{i(1)},e[8]=R):R=e[8],e[9]!==l?(G=[l],e[9]=l,e[10]=G):G=e[10],w.useEffect(R,G),e[11]!==A?.hasMore||e[12]!==M?(Q=()=>{A?.hasMore&&!M&&i(K)},e[11]=A?.hasMore,e[12]=M,e[13]=Q):Q=e[13];const X=Q;let Y;e[14]===Symbol.for("react.memo_cache_sentinel")?(Y=e=>{P(void 0===e?null:e),j(!0)},e[14]=Y):Y=e[14];const J=Y;let Z;e[15]!==B||e[16]!==O?(Z=async e=>{try{await B(e).unwrap(),h.success("Admin berhasil dihapus"),i(1),O()}catch(a){h.error("Gagal menghapus admin")}},e[15]=B,e[16]=O,e[17]=Z):Z=e[17];const $=Z;let ee;e[18]!==O?(ee=()=>{j(!1),P(null),i(1),O()},e[18]=O,e[19]=ee):ee=e[19];const ae=ee;let se;e[20]!==$||e[21]!==q?(se=e=>{const a="center"===e.level;return n.jsx(f,{hoverable:!0,style:{height:"100%"},bodyStyle:{padding:"16px"},children:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[n.jsxs("div",{style:{display:"flex",gap:12,flex:1,minWidth:0},children:[n.jsx(b,{size:48,icon:n.jsx(c,{}),style:{backgroundColor:a?"#faad14":"#1890ff",flexShrink:0}}),n.jsxs("div",{style:{minWidth:0,flex:1},children:[n.jsxs(H,{level:5,style:{margin:0,fontSize:15},ellipsis:!0,children:[e.full_name,a&&n.jsx(E,{style:{color:"#faad14",marginLeft:6}})]}),n.jsxs(U,{type:"secondary",style:{fontSize:12,display:"block"},ellipsis:{tooltip:e.username},children:["@",e.username]}),n.jsx(U,{type:"secondary",style:{fontSize:11,display:"block",color:"#aaa"},ellipsis:{tooltip:e.email},children:e.email||"-"}),n.jsxs("div",{style:{marginTop:8,display:"flex",gap:4,flexWrap:"wrap"},children:[n.jsx(L,{color:a?"gold":"blue",style:{margin:0,fontSize:10},children:e.level.toUpperCase()}),n.jsx(L,{color:e.is_active?"success":"error",style:{margin:0,fontSize:10},children:e.is_active?"AKTIF":"NONAKTIF"})]})]})]}),n.jsxs(y,{vertical:!0,size:0,children:[n.jsx(g,{title:"Edit",children:n.jsx(_,{type:"text",size:"small",icon:n.jsx(S,{style:{color:"orange"}}),onClick:()=>J(e)})}),n.jsx(T,{title:"Hapus Admin?",onConfirm:()=>$(e.id),disabled:a,okText:"Ya",cancelText:"Batal",children:n.jsx(_,{type:"text",size:"small",danger:!0,icon:n.jsx(F,{}),disabled:a,loading:q})})]})]})})},e[20]=$,e[21]=q,e[22]=se):se=e[22];const ie=se;let le,te,ne,re;e[23]===Symbol.for("react.memo_cache_sentinel")?(le={display:"flex",justifyContent:"space-between",marginBottom:16,gap:10},e[23]=le):le=e[23],e[24]===Symbol.for("react.memo_cache_sentinel")?(te=n.jsx(v,{}),e[24]=te):te=e[24],e[25]===Symbol.for("react.memo_cache_sentinel")?(ne=n.jsx(o,{placeholder:"Cari nama atau username...",prefix:te,allowClear:!0,onChange:e=>t(e.target.value),style:{maxWidth:300}}),e[25]=ne):ne=e[25],e[26]===Symbol.for("react.memo_cache_sentinel")?(re=n.jsxs("div",{style:le,children:[ne,n.jsx(_,{type:"primary",icon:n.jsx(k,{}),onClick:()=>J(null),children:"Tambah Admin"})]}),e[26]=re):re=e[26];const oe=A?.hasMore;let ce,me,de,he,ue;return e[27]===Symbol.for("react.memo_cache_sentinel")?(ce={gutter:[16,16],xs:24,sm:12,md:12,lg:8,xl:6,xxl:6},e[27]=ce):ce=e[27],e[28]!==X||e[29]!==M||e[30]!==m||e[31]!==ie||e[32]!==oe?(me=n.jsx(C,{data:m,loading:M,hasMore:oe,onLoadMore:X,renderItem:ie,height:"75vh",emptyText:"Belum ada data admin",grid:ce}),e[28]=X,e[29]=M,e[30]=m,e[31]=ie,e[32]=oe,e[33]=me):me=e[33],e[34]===Symbol.for("react.memo_cache_sentinel")?(de=()=>j(!1),e[34]=de):de=e[34],e[35]!==I||e[36]!==ae||e[37]!==u?(he=n.jsx(W,{open:u,initialData:I,onCancel:de,onSuccess:ae}),e[35]=I,e[36]=ae,e[37]=u,e[38]=he):he=e[38],e[39]!==me||e[40]!==he?(ue=n.jsxs(n.Fragment,{children:[re,me,he]}),e[39]=me,e[40]=he,e[41]=ue):ue=e[41],ue};function K(e){return e+1}export{V as default};
