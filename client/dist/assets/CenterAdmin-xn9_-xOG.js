import{I as e,k as a,F as s,L as l,U as i,V as t,o as n,C as r,y as o,p as c,x as m,q as d,D as h,z as u,W as x,X as p,T as f,s as j,A as b,Y as y,N as g,B as _,O as S,Q as v,S as k,w}from"./index-IfHJv5WL.js";import{r as C}from"./vendor-kOq7Q5-U.js";import{I as A}from"./InfiniteScrollList-Chj7-TfW.js";import{a as I}from"./index-CPaPbrqg.js";import{R as z}from"./PhoneOutlined-DIZ3kFQ0.js";import{S as L}from"./index-CZjB1WBU.js";import{M as P}from"./index-CQKi3m8Y.js";import{T}from"./index-BM57nN4D.js";import{P as O}from"./index-BodHHeJo.js";import{R as F}from"./DeleteOutlined-BgrfJ2kJ.js";import"./charts-DyIopC3t.js";import"./index-BSxM1sbQ.js";import"./index-C5Y2dds-.js";import"./ActionButton-CwPtgC52.js";var M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M899.6 276.5L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.7-3.5-13.1 1.2-12.2 7.9L188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.8-6.7-6.5-11.4-12.3-7.9zM512 734.2c-62.1 0-112.6-50.5-112.6-112.6S449.9 509 512 509s112.6 50.5 112.6 112.6S574.1 734.2 512 734.2zm0-160.9c-26.6 0-48.2 21.6-48.2 48.3 0 26.6 21.6 48.3 48.2 48.3s48.2-21.6 48.2-48.3c0-26.6-21.6-48.3-48.2-48.3z"}}]},name:"crown",theme:"filled"};function B(){return B=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},B.apply(this,arguments)}const N=(a,s)=>C.createElement(e,B({},a,{ref:s,icon:M})),q=C.forwardRef(N),{Option:E}=I,W=e=>{const x=a.c(52),{open:p,onCancel:f,onSuccess:j,initialData:b}=e,[y]=s.useForm();let g;x[0]===Symbol.for("react.memo_cache_sentinel")?(g={page:1,limit:100},x[0]=g):g=x[0];const{data:_,isLoading:S}=l(g),[v,k]=i(),{isLoading:w}=k,[A,T]=t(),{isLoading:O}=T;let F,M,B;x[1]!==y||x[2]!==b||x[3]!==p?(F=()=>{p&&(b?y.setFieldsValue({...b,password:"",homebase_id:b.homebase_id||void 0}):y.resetFields())},M=[p,b,y],x[1]=y,x[2]=b,x[3]=p,x[4]=F,x[5]=M):(F=x[4],M=x[5]),C.useEffect(F,M),x[6]!==v||x[7]!==y||x[8]!==b||x[9]!==j||x[10]!==A?(B=async e=>{try{"satuan"!==e.level&&(e.homebase_id=null),b?(await A({id:b.id,...e}).unwrap(),h.success("Data admin diperbarui")):(await v(e).unwrap(),h.success("Admin baru ditambahkan")),y.resetFields(),j()}catch(a){const e=a;h.error(e?.data?.message||"Terjadi kesalahan")}},x[6]=v,x[7]=y,x[8]=b,x[9]=j,x[10]=A,x[11]=B):B=x[11];const N=B,q=b?"Edit Admin":"Tambah Admin Baru",W=w||O;let U,V,R;x[12]===Symbol.for("react.memo_cache_sentinel")?(U=[{required:!0,message:"Wajib diisi"}],x[12]=U):U=x[12],x[13]===Symbol.for("react.memo_cache_sentinel")?(V=n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"full_name",label:"Nama Lengkap",rules:U,children:n.jsx(o,{placeholder:"Nama Admin",prefix:n.jsx(c,{})})})}),x[13]=V):V=x[13],x[14]===Symbol.for("react.memo_cache_sentinel")?(R=[{required:!0,message:"Wajib diisi"}],x[14]=R):R=x[14];const K=!!b;let Y,G,Q,X,J,Z;x[15]!==K?(Y=n.jsxs(m,{gutter:16,children:[V,n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"username",label:"Username",rules:R,children:n.jsx(o,{placeholder:"Username Login",disabled:K})})})]}),x[15]=K,x[16]=Y):Y=x[16],x[17]===Symbol.for("react.memo_cache_sentinel")?(G=[{required:!0,message:"Pilih level akses"}],x[17]=G):G=x[17],x[18]===Symbol.for("react.memo_cache_sentinel")?(Q=n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"level",label:"Level Akses",initialValue:"admin",rules:G,children:n.jsxs(I,{placeholder:"Pilih Level",children:[n.jsx(E,{value:"pusat",children:"Pusat"}),n.jsx(E,{value:"satuan",children:"Satuan (Sekolah)"}),n.jsx(E,{value:"tahfiz",children:"Tahfiz"})]})})}),x[18]=Q):Q=x[18],x[19]===Symbol.for("react.memo_cache_sentinel")?(X=n.jsxs(m,{gutter:16,children:[Q,n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"phone",label:"No. Telepon",children:n.jsx(o,{placeholder:"08xxx",prefix:n.jsx(z,{})})})})]}),x[19]=X):X=x[19],x[20]!==_?.data||x[21]!==S?(J=n.jsx(s.Item,{noStyle:!0,shouldUpdate:D,children:e=>{const{getFieldValue:a}=e;return"satuan"===a("level")?n.jsx(s.Item,{name:"homebase_id",label:"Pilih Satuan Pendidikan (Homebase)",rules:[{required:!0,message:"Admin Satuan wajib memilih Homebase!"}],children:n.jsx(I,{placeholder:"Pilih Homebase",loading:S,allowClear:!0,showSearch:!0,optionFilterProp:"children",children:_?.data?.map(H)})}):null}}),x[20]=_?.data,x[21]=S,x[22]=J):J=x[22],x[23]===Symbol.for("react.memo_cache_sentinel")?(Z=n.jsx(s.Item,{name:"email",label:"Email",children:n.jsx(o,{placeholder:"email@sekolah.com",prefix:n.jsx(d,{})})}),x[23]=Z):Z=x[23];const $=b?"Password Baru (Opsional)":"Password",ee=!b;let ae,se,le,ie;x[24]!==ee?(ae={required:ee,message:"Password wajib diisi untuk admin baru"},x[24]=ee,x[25]=ae):ae=x[25],x[26]===Symbol.for("react.memo_cache_sentinel")?(se={min:6,message:"Minimal 6 karakter"},x[26]=se):se=x[26],x[27]!==ae?(le=[ae,se],x[27]=ae,x[28]=le):le=x[28],x[29]===Symbol.for("react.memo_cache_sentinel")?(ie=n.jsx(u,{}),x[29]=ie):ie=x[29];const te=b?"Isi jika ingin mengganti password":"Password akun";let ne,re,oe,ce,me;return x[30]!==te?(ne=n.jsx(o.Password,{prefix:ie,placeholder:te}),x[30]=te,x[31]=ne):ne=x[31],x[32]!==$||x[33]!==le||x[34]!==ne?(re=n.jsx(s.Item,{name:"password",label:$,rules:le,children:ne}),x[32]=$,x[33]=le,x[34]=ne,x[35]=re):re=x[35],x[36]!==b?(oe=b&&n.jsx(s.Item,{name:"is_active",label:"Status Akun",valuePropName:"checked",children:n.jsx(L,{checkedChildren:"Aktif",unCheckedChildren:"Nonaktif"})}),x[36]=b,x[37]=oe):oe=x[37],x[38]!==y||x[39]!==N||x[40]!==Y||x[41]!==J||x[42]!==re||x[43]!==oe?(ce=n.jsxs(s,{form:y,layout:"vertical",onFinish:N,children:[Y,X,J,Z,re,oe]}),x[38]=y,x[39]=N,x[40]=Y,x[41]=J,x[42]=re,x[43]=oe,x[44]=ce):ce=x[44],x[45]!==y.submit||x[46]!==f||x[47]!==p||x[48]!==ce||x[49]!==q||x[50]!==W?(me=n.jsx(P,{title:q,open:p,onCancel:f,onOk:y.submit,confirmLoading:W,destroyOnHidden:!0,width:600,children:ce}),x[45]=y.submit,x[46]=f,x[47]=p,x[48]=ce,x[49]=q,x[50]=W,x[51]=me):me=x[51],me};function D(e,a){return e.level!==a.level}function H(e){return n.jsx(E,{value:e.id,children:e.name},e.id)}const{Title:U,Text:V}=f,R=()=>{const e=a.c(42),[s,l]=C.useState(1),[i,t]=C.useState("");let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=[],e[0]=r):r=e[0];const[m,d]=C.useState(r),[u,f]=C.useState(!1),[I,z]=C.useState(null);let L;e[1]!==s||e[2]!==i?(L={page:s,limit:10,search:i},e[1]=s,e[2]=i,e[3]=L):L=e[3];const{data:P,isFetching:M,refetch:B}=x(L),[N,E]=p(),{isLoading:D}=E;let H,R,Y,G,Q;e[4]!==P||e[5]!==s?(H=()=>{P?.data&&d(1===s?P.data:e=>{const a=P.data.filter(a=>!e.some(e=>e.id===a.id));return[...e,...a]})},R=[P,s],e[4]=P,e[5]=s,e[6]=H,e[7]=R):(H=e[6],R=e[7]),C.useEffect(H,R),e[8]===Symbol.for("react.memo_cache_sentinel")?(Y=()=>{l(1)},e[8]=Y):Y=e[8],e[9]!==i?(G=[i],e[9]=i,e[10]=G):G=e[10],C.useEffect(Y,G),e[11]!==P?.hasMore||e[12]!==M?(Q=()=>{P?.hasMore&&!M&&l(K)},e[11]=P?.hasMore,e[12]=M,e[13]=Q):Q=e[13];const X=Q;let J;e[14]===Symbol.for("react.memo_cache_sentinel")?(J=e=>{z(void 0===e?null:e),f(!0)},e[14]=J):J=e[14];const Z=J;let $;e[15]!==N||e[16]!==B?($=async e=>{try{await N(e).unwrap(),h.success("Admin berhasil dihapus"),l(1),B()}catch(a){h.error("Gagal menghapus admin")}},e[15]=N,e[16]=B,e[17]=$):$=e[17];const ee=$;let ae;e[18]!==B?(ae=()=>{f(!1),z(null),l(1),B()},e[18]=B,e[19]=ae):ae=e[19];const se=ae;let le;e[20]!==ee||e[21]!==D?(le=e=>{const a="center"===e.level;return n.jsx(j,{hoverable:!0,style:{height:"100%"},bodyStyle:{padding:"16px"},children:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[n.jsxs("div",{style:{display:"flex",gap:12,flex:1,minWidth:0},children:[n.jsx(b,{size:48,icon:n.jsx(c,{}),style:{backgroundColor:a?"#faad14":"#1890ff",flexShrink:0}}),n.jsxs("div",{style:{minWidth:0,flex:1},children:[n.jsxs(U,{level:5,style:{margin:0,fontSize:15},ellipsis:!0,children:[e.full_name,a&&n.jsx(q,{style:{color:"#faad14",marginLeft:6}})]}),n.jsxs(V,{type:"secondary",style:{fontSize:12,display:"block"},ellipsis:{tooltip:e.username},children:["@",e.username]}),n.jsx(V,{type:"secondary",style:{fontSize:11,display:"block",color:"#aaa"},ellipsis:{tooltip:e.email},children:e.email||"-"}),n.jsxs("div",{style:{marginTop:8,display:"flex",gap:4,flexWrap:"wrap"},children:[n.jsx(T,{color:a?"gold":"blue",style:{margin:0,fontSize:10},children:e.level.toUpperCase()}),n.jsx(T,{color:e.is_active?"success":"error",style:{margin:0,fontSize:10},children:e.is_active?"AKTIF":"NONAKTIF"})]})]})]}),n.jsxs(y,{vertical:!0,size:0,children:[n.jsx(g,{title:"Edit",children:n.jsx(_,{type:"text",size:"small",icon:n.jsx(S,{style:{color:"orange"}}),onClick:()=>Z(e)})}),n.jsx(O,{title:"Hapus Admin?",onConfirm:()=>ee(e.id),disabled:a,okText:"Ya",cancelText:"Batal",children:n.jsx(_,{type:"text",size:"small",danger:!0,icon:n.jsx(F,{}),disabled:a,loading:D})})]})]})})},e[20]=ee,e[21]=D,e[22]=le):le=e[22];const ie=le;let te,ne,re,oe;e[23]===Symbol.for("react.memo_cache_sentinel")?(te={display:"flex",justifyContent:"space-between",marginBottom:16,gap:10},e[23]=te):te=e[23],e[24]===Symbol.for("react.memo_cache_sentinel")?(ne=n.jsx(v,{}),e[24]=ne):ne=e[24],e[25]===Symbol.for("react.memo_cache_sentinel")?(re=n.jsx(o,{placeholder:"Cari nama atau username...",prefix:ne,allowClear:!0,onChange:e=>t(e.target.value),style:{maxWidth:300}}),e[25]=re):re=e[25],e[26]===Symbol.for("react.memo_cache_sentinel")?(oe=n.jsxs("div",{style:te,children:[re,n.jsx(_,{type:"primary",icon:n.jsx(k,{}),onClick:()=>Z(null),children:"Tambah Admin"})]}),e[26]=oe):oe=e[26];const ce=P?.hasMore;let me,de,he,ue,xe;return e[27]===Symbol.for("react.memo_cache_sentinel")?(me={gutter:[16,16],xs:24,sm:12,md:12,lg:8,xl:6,xxl:6},e[27]=me):me=e[27],e[28]!==X||e[29]!==M||e[30]!==m||e[31]!==ie||e[32]!==ce?(de=n.jsx(A,{data:m,loading:M,hasMore:ce,onLoadMore:X,renderItem:ie,height:"75vh",emptyText:"Belum ada data admin",grid:me}),e[28]=X,e[29]=M,e[30]=m,e[31]=ie,e[32]=ce,e[33]=de):de=e[33],e[34]===Symbol.for("react.memo_cache_sentinel")?(he=()=>f(!1),e[34]=he):he=e[34],e[35]!==I||e[36]!==se||e[37]!==u?(ue=n.jsx(W,{open:u,initialData:I,onCancel:he,onSuccess:se}),e[35]=I,e[36]=se,e[37]=u,e[38]=ue):ue=e[38],e[39]!==de||e[40]!==ue?(xe=n.jsxs(w,{title:"Manajemen Admin",children:[oe,de,ue]}),e[39]=de,e[40]=ue,e[41]=xe):xe=e[41],xe};function K(e){return e+1}export{R as default};
