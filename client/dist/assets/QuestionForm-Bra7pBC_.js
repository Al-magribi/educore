import{az as e,k as s,o as a,F as i,s as t,x as r,aF as n,ax as o,e3 as l,e4 as c,aL as d,X as p,B as m,z as j}from"./index-DJgzJvx0.js";import{r as u}from"./vendor-kOq7Q5-U.js";import{E as x,T as h,G as f,O as b,a as y,b as g}from"./BankList-C3aNz1gE.js";import{X as k}from"./QuestionsList-IHokxBlu.js";import{S as z}from"./index-ZAZRIL-n.js";import{T as v}from"./index-Dixg4MZV.js";import{D as S}from"./index-Ddh-PgSR.js";import{S as w}from"./save-4y8l8Hx8.js";import{C as _}from"./circle-check--2TOZgwe.js";import{L as C}from"./list-checks-CUXdcjSw.js";import{A as M}from"./index-D-YBaVh2.js";import"./charts-4CCI6hAs.js";import"./InfiniteScrollList-CRQVFRuq.js";import"./index-CsPvpU6M.js";import"./index-BzygXUWO.js";import"./user-CZPLsXqQ.js";import"./katex-_9UfHwjh.js";import"./trash-2-AcrYeN4V.js";import"./plus-BlyBk2I3.js";import"./layers-BM2-Q3cP.js";import"./user-round-BNUrar0_.js";import"./Table-Bpp4NRb8.js";import"./index-Bjno29EH.js";import"./useClosable-BMlLLbW6.js";import"./index-A8UrXWNV.js";import"./search-DCbkSk8T.js";import"./folder-BTrw0U5E.js";import"./file-text-Z3y9FrNB.js";import"./book-open-Bg2XmE5G.js";import"./square-pen-BDUCvEEX.js";import"./index-C1pdE3N8.js";import"./ActionButton-DZkZ4UyV.js";import"./calendar-BUsp4a-K.js";import"./index-CWRbA1GH.js";import"./context-Co2t6AGx.js";import"./useMergedMask-hWGqm8nf.js";import"./arrow-left-DYE7YoY3.js";import"./Collapse-D57cS8Q2.js";const q=e("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),B=e("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),F=e("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]),I=e=>{const o=s.c(5),{form:l}=e;let c;o[0]!==l?(c=e=>{const s=l.getFieldValue("options").map((s,a)=>({...s,is_correct:a===e}));l.setFieldsValue({options:s})},o[0]=l,o[1]=c):c=o[1];const d=c;let p;return o[2]!==l||o[3]!==d?(p=a.jsx(i.List,{name:"options",children:e=>a.jsx("div",{style:{display:"flex",gap:16},children:e.map((e,s)=>{const{key:o,name:c}=e,p=l.getFieldValue(["options",s,"content"]),m=l.getFieldValue(["options",s,"is_correct"]);return a.jsxs(t,{hoverable:!0,onClick:()=>d(s),style:{flex:1,textAlign:"center",borderColor:m?0===s?"#52c41a":"#ff4d4f":"#d9d9d9",backgroundColor:m?0===s?"#f6ffed":"#fff1f0":"#fff",transition:"all 0.3s"},children:[a.jsx("div",{style:{fontSize:24,marginBottom:8,color:m?0===s?"#52c41a":"#ff4d4f":"#ccc"},children:0===s?a.jsx(q,{size:32}):a.jsx(k,{size:32})}),a.jsx("div",{style:{fontSize:16,fontWeight:"bold"},children:p}),a.jsx(i.Item,{name:[c,"content"],hidden:!0,children:a.jsx(r,{})}),a.jsx(i.Item,{name:[c,"is_correct"],hidden:!0,valuePropName:"checked",children:a.jsx(n,{})})]},o)})})}),o[2]=l,o[3]=d,o[4]=p):p=o[4],p},{useBreakpoint:T}=o,L=[{label:"PG Jawaban Tunggal",value:1,icon:a.jsx(_,{size:16})},{label:"PG Multi Jawaban",value:2,icon:a.jsx(B,{size:16})},{label:"Uraian",value:3,icon:a.jsx(F,{size:16})},{label:"Isian Singkat",value:4,icon:a.jsx(h,{size:16})},{label:"Benar / Salah",value:5,icon:a.jsx(C,{size:16})},{label:"Menjodohkan",value:6,icon:a.jsx(f,{size:16})}],V=({initialData:e,bankSoalId:s,onSaveSuccess:r,onCancel:n})=>{const o=T(),[h]=i.useForm(),[f,k]=u.useState(1),[_,{isLoading:C}]=l(),[q,{isLoading:B}]=c(),F=C||B;u.useEffect(()=>{e?(h.setFieldsValue(e),k(e.q_type)):V(1)},[e,h]);const V=e=>{let s=[];1===e||2===e?s=[{content:"",is_correct:!0},{content:"",is_correct:!1},{content:"",is_correct:!1},{content:"",is_correct:!1}]:5===e?s=[{content:"Benar",is_correct:!0},{content:"Salah",is_correct:!1}]:6===e?s=[{label:"",content:"",is_correct:!0}]:4===e&&(s=[{content:"",is_correct:!0}]),h.setFieldsValue({q_type:e,content:"",options:s,score_point:1}),k(e)};return a.jsx(t,{hoverable:!0,children:a.jsxs(i,{form:h,layout:"vertical",onFinish:async a=>{try{const i={...a,bank_soal_id:s};e?.id?(await q({id:e.id,...i}).unwrap(),j.success("Soal berhasil diperbarui")):(await _(i).unwrap(),j.success("Soal berhasil ditambahkan")),r()}catch(i){j.error(i?.data?.message||"Gagal menyimpan soal")}},initialValues:{q_type:1,score_weight:1},children:[a.jsxs(d,{justify:"space-between",align:"center",gap:o.sm?"large":"small",wrap:!0,children:[a.jsx(i.Item,{name:"q_type",label:"Tipe Soal",rules:[{required:!0}],style:{flex:1},children:a.jsx(z,{onChange:e=>{V(e)},size:"large",children:L.map(e=>a.jsx(z.Option,{value:e.value,children:a.jsxs(p,{children:[e.icon,e.label]})},e.value))})}),a.jsx(i.Item,{name:"score_point",label:"Bobot Skor",rules:[{required:!0}],children:a.jsx(v,{min:1,style:{width:"100%"},size:"large"})})]}),a.jsx(S,{}),a.jsx(i.Item,{name:"content",label:a.jsx("span",{style:{fontSize:16,fontWeight:600},children:"Pertanyaan"}),rules:[{required:!0,message:"Tulis pertanyaan soal"}],children:a.jsx(x,{placeholder:"Tulis soal disini (Gunakan toolbar untuk insert gambar/rumus)...",height:"300px"})}),a.jsxs("div",{style:{background:"#fff",marginTop:40},children:[a.jsx(S,{titlePlacement:"left",style:{borderColor:"#eee"},children:"Kunci Jawaban & Opsi"}),(()=>{switch(f){case 1:return a.jsx(g,{form:h,isMulti:!1});case 2:return a.jsx(g,{form:h,isMulti:!0});case 3:return a.jsx(M,{title:"Tipe Soal Uraian",description:"Untuk tipe soal uraian (Essay), tidak ada kunci jawaban otomatis. Jawaban siswa akan diperiksa secara manual oleh guru.",type:"warning",showIcon:!0});case 4:return a.jsx(y,{});case 5:return a.jsx(I,{form:h});case 6:return a.jsx(b,{});default:return null}})()]}),a.jsx(S,{}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:12},children:[a.jsx(m,{onClick:n,disabled:F,size:"large",children:"Batal"}),a.jsx(m,{type:"primary",htmlType:"submit",icon:a.jsx(w,{size:18}),loading:F,size:"large",children:e?"Perbarui Soal":"Simpan Soal"})]})]})})};export{V as default};
