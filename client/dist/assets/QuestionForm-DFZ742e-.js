import{aA as e,k as s,o as a,F as t,s as i,x as r,aG as n,ay as o,dN as l,dO as c,aM as d,X as p,B as m,z as u}from"./index-BMgVGS0W.js";import{r as j}from"./vendor-kOq7Q5-U.js";import{E as x,T as h,G as f,O as y,a as b,b as g}from"./BankList-MrF6HrUz.js";import{X as k}from"./QuestionsList-C3PSFpsF.js";import{S as v}from"./index-BaY85u3L.js";import{T as z}from"./index-BCuIdPfH.js";import{D as S}from"./index-FSaxVOpe.js";import{C as _}from"./folder-BthID8he.js";import{L as w}from"./list-checks-BXa4yIiK.js";import{A as M}from"./index-B7D5Q1n-.js";import"./charts-CwbbN17O.js";import"./InfiniteScrollList-DsHuus8o.js";import"./index-uTpWdo5L.js";import"./index-CmsZKls5.js";import"./user-BdspMW-a.js";import"./trash-2-CUj98Q3w.js";import"./layers-Bxc3rwJ3.js";import"./user-round-BbyHwokm.js";import"./Table-B1CPEX6C.js";import"./index-sQwj4XUc.js";import"./useClosable-CyYxAYSl.js";import"./index-hPZPoAPD.js";import"./search-DM2czfgU.js";import"./book-open-DJbUen71.js";import"./square-pen-BLm4MSMw.js";import"./index-BVGPo9j5.js";import"./ActionButton-DfMNmIbJ.js";import"./calendar-Buqc-itz.js";import"./index-CDsHpMr4.js";import"./context-CW6N5AXl.js";import"./arrow-left-C3khm80O.js";import"./Collapse-DDhUhx11.js";const C=e("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),V=e("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),B=e("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),T=e("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]),q=e=>{const o=s.c(5),{form:l}=e;let c;o[0]!==l?(c=e=>{const s=l.getFieldValue("options").map((s,a)=>({...s,is_correct:a===e}));l.setFieldsValue({options:s})},o[0]=l,o[1]=c):c=o[1];const d=c;let p;return o[2]!==l||o[3]!==d?(p=a.jsx(t.List,{name:"options",children:e=>a.jsx("div",{style:{display:"flex",gap:16},children:e.map((e,s)=>{const{key:o,name:c}=e,p=l.getFieldValue(["options",s,"content"]),m=l.getFieldValue(["options",s,"is_correct"]);return a.jsxs(i,{hoverable:!0,onClick:()=>d(s),style:{flex:1,textAlign:"center",borderColor:m?0===s?"#52c41a":"#ff4d4f":"#d9d9d9",backgroundColor:m?0===s?"#f6ffed":"#fff1f0":"#fff",transition:"all 0.3s"},children:[a.jsx("div",{style:{fontSize:24,marginBottom:8,color:m?0===s?"#52c41a":"#ff4d4f":"#ccc"},children:0===s?a.jsx(C,{size:32}):a.jsx(k,{size:32})}),a.jsx("div",{style:{fontSize:16,fontWeight:"bold"},children:p}),a.jsx(t.Item,{name:[c,"content"],hidden:!0,children:a.jsx(r,{})}),a.jsx(t.Item,{name:[c,"is_correct"],hidden:!0,valuePropName:"checked",children:a.jsx(n,{})})]},o)})})}),o[2]=l,o[3]=d,o[4]=p):p=o[4],p},{useBreakpoint:F}=o,I=[{label:"PG Jawaban Tunggal",value:1,icon:a.jsx(_,{size:16})},{label:"PG Multi Jawaban",value:2,icon:a.jsx(B,{size:16})},{label:"Uraian",value:3,icon:a.jsx(T,{size:16})},{label:"Isian Singkat",value:4,icon:a.jsx(h,{size:16})},{label:"Benar / Salah",value:5,icon:a.jsx(w,{size:16})},{label:"Menjodohkan",value:6,icon:a.jsx(f,{size:16})}],L=({initialData:e,bankSoalId:s,onSaveSuccess:r,onCancel:n})=>{const o=F(),[h]=t.useForm(),[f,k]=j.useState(1),[_,{isLoading:w}]=l(),[C,{isLoading:B}]=c(),T=w||B;j.useEffect(()=>{e?(h.setFieldsValue(e),k(e.q_type)):L(1)},[e,h]);const L=e=>{let s=[];1===e||2===e?s=[{content:"",is_correct:!0},{content:"",is_correct:!1},{content:"",is_correct:!1},{content:"",is_correct:!1}]:5===e?s=[{content:"Benar",is_correct:!0},{content:"Salah",is_correct:!1}]:6===e?s=[{label:"",content:"",is_correct:!0}]:4===e&&(s=[{content:"",is_correct:!0}]),h.setFieldsValue({q_type:e,content:"",options:s,score_point:1}),k(e)};return a.jsx(i,{hoverable:!0,children:a.jsxs(t,{form:h,layout:"vertical",onFinish:async a=>{try{const t={...a,bank_soal_id:s};e?.id?(await C({id:e.id,...t}).unwrap(),u.success("Soal berhasil diperbarui")):(await _(t).unwrap(),u.success("Soal berhasil ditambahkan")),r()}catch(t){u.error(t?.data?.message||"Gagal menyimpan soal")}},initialValues:{q_type:1,score_weight:1},children:[a.jsxs(d,{justify:"space-between",align:"center",gap:o.sm?"large":"small",wrap:!0,children:[a.jsx(t.Item,{name:"q_type",label:"Tipe Soal",rules:[{required:!0}],style:{flex:1},children:a.jsx(v,{onChange:e=>{L(e)},size:"large",children:I.map(e=>a.jsx(v.Option,{value:e.value,children:a.jsxs(p,{children:[e.icon,e.label]})},e.value))})}),a.jsx(t.Item,{name:"score_point",label:"Bobot Skor",rules:[{required:!0}],children:a.jsx(z,{min:1,style:{width:"100%"},size:"large"})})]}),a.jsx(S,{}),a.jsx(t.Item,{name:"content",label:a.jsx("span",{style:{fontSize:16,fontWeight:600},children:"Pertanyaan"}),rules:[{required:!0,message:"Tulis pertanyaan soal"}],children:a.jsx(x,{placeholder:"Tulis soal disini (Gunakan toolbar untuk insert gambar/rumus)...",height:"300px"})}),a.jsxs("div",{style:{background:"#fff",marginTop:40},children:[a.jsx(S,{titlePlacement:"left",style:{borderColor:"#eee"},children:"Kunci Jawaban & Opsi"}),(()=>{switch(f){case 1:return a.jsx(g,{form:h,isMulti:!1});case 2:return a.jsx(g,{form:h,isMulti:!0});case 3:return a.jsx(M,{title:"Tipe Soal Uraian",description:"Untuk tipe soal uraian (Essay), tidak ada kunci jawaban otomatis. Jawaban siswa akan diperiksa secara manual oleh guru.",type:"warning",showIcon:!0});case 4:return a.jsx(b,{});case 5:return a.jsx(q,{form:h});case 6:return a.jsx(y,{});default:return null}})()]}),a.jsx(S,{}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:12},children:[a.jsx(m,{onClick:n,disabled:T,size:"large",children:"Batal"}),a.jsx(m,{type:"primary",htmlType:"submit",icon:a.jsx(V,{size:18}),loading:T,size:"large",children:e?"Perbarui Soal":"Simpan Soal"})]})]})})};export{L as default};
