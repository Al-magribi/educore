import{aR as e,k as a,o as s,F as t,s as i,y as r,bN as n,az as o,dN as l,dO as c,aX as d,Y as p,B as m,D as u}from"./index-IfHJv5WL.js";import{r as j}from"./vendor-kOq7Q5-U.js";import{E as h,T as x,G as f,O as y,a as b,b as k}from"./BankList-BgV45LBG.js";import{X as g}from"./QuestionsList-BZZs2yX4.js";import{a as v}from"./index-CPaPbrqg.js";import{T as z}from"./index-CYMh9ovW.js";import{D as _}from"./index-C5Y2dds-.js";import{C as w}from"./folder-bVWEsWbr.js";import{L as S}from"./list-checks-Dc61Ucz3.js";import{A as M}from"./index-Ck6zxCm-.js";import"./charts-DyIopC3t.js";import"./InfiniteScrollList-Chj7-TfW.js";import"./index-BSxM1sbQ.js";import"./user-CGUempjp.js";import"./trash-2-BcDficLO.js";import"./layers-BPTf1la7.js";import"./user-round-C1oGp78w.js";import"./Table-ClpUx-_a.js";import"./index-bEkSGdHP.js";import"./index-BM57nN4D.js";import"./book-open-CsjBihp8.js";import"./square-pen-B2Wybh49.js";import"./index-BodHHeJo.js";import"./ActionButton-CwPtgC52.js";import"./calendar-DBIrUUfk.js";import"./index-CQKi3m8Y.js";import"./arrow-left-BZHRaujE.js";import"./Collapse-Fprp8MNI.js";const V=e("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),T=e("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),q=e("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),B=e("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]),C=e=>{const o=a.c(5),{form:l}=e;let c;o[0]!==l?(c=e=>{const a=l.getFieldValue("options").map((a,s)=>({...a,is_correct:s===e}));l.setFieldsValue({options:a})},o[0]=l,o[1]=c):c=o[1];const d=c;let p;return o[2]!==l||o[3]!==d?(p=s.jsx(t.List,{name:"options",children:e=>s.jsx("div",{style:{display:"flex",gap:16},children:e.map((e,a)=>{const{key:o,name:c}=e,p=l.getFieldValue(["options",a,"content"]),m=l.getFieldValue(["options",a,"is_correct"]);return s.jsxs(i,{hoverable:!0,onClick:()=>d(a),style:{flex:1,textAlign:"center",borderColor:m?0===a?"#52c41a":"#ff4d4f":"#d9d9d9",backgroundColor:m?0===a?"#f6ffed":"#fff1f0":"#fff",transition:"all 0.3s"},children:[s.jsx("div",{style:{fontSize:24,marginBottom:8,color:m?0===a?"#52c41a":"#ff4d4f":"#ccc"},children:0===a?s.jsx(V,{size:32}):s.jsx(g,{size:32})}),s.jsx("div",{style:{fontSize:16,fontWeight:"bold"},children:p}),s.jsx(t.Item,{name:[c,"content"],hidden:!0,children:s.jsx(r,{})}),s.jsx(t.Item,{name:[c,"is_correct"],hidden:!0,valuePropName:"checked",children:s.jsx(n,{})})]},o)})})}),o[2]=l,o[3]=d,o[4]=p):p=o[4],p},{useBreakpoint:F}=o,I=[{label:"PG Jawaban Tunggal",value:1,icon:s.jsx(w,{size:16})},{label:"PG Multi Jawaban",value:2,icon:s.jsx(q,{size:16})},{label:"Uraian",value:3,icon:s.jsx(B,{size:16})},{label:"Isian Singkat",value:4,icon:s.jsx(x,{size:16})},{label:"Benar / Salah",value:5,icon:s.jsx(S,{size:16})},{label:"Menjodohkan",value:6,icon:s.jsx(f,{size:16})}],L=({initialData:e,bankSoalId:a,onSaveSuccess:r,onCancel:n})=>{const o=F(),[x]=t.useForm(),[f,g]=j.useState(1),[w,{isLoading:S}]=l(),[V,{isLoading:q}]=c(),B=S||q;j.useEffect(()=>{e?(x.setFieldsValue(e),g(e.q_type)):L(1)},[e,x]);const L=e=>{let a=[];1===e||2===e?a=[{content:"",is_correct:!0},{content:"",is_correct:!1},{content:"",is_correct:!1},{content:"",is_correct:!1}]:5===e?a=[{content:"Benar",is_correct:!0},{content:"Salah",is_correct:!1}]:6===e?a=[{label:"",content:"",is_correct:!0}]:4===e&&(a=[{content:"",is_correct:!0}]),x.setFieldsValue({q_type:e,content:"",options:a,score_point:1}),g(e)};return s.jsx(i,{hoverable:!0,children:s.jsxs(t,{form:x,layout:"vertical",onFinish:async s=>{try{const t={...s,bank_soal_id:a};e?.id?(await V({id:e.id,...t}).unwrap(),u.success("Soal berhasil diperbarui")):(await w(t).unwrap(),u.success("Soal berhasil ditambahkan")),r()}catch(t){u.error(t?.data?.message||"Gagal menyimpan soal")}},initialValues:{q_type:1,score_weight:1},children:[s.jsxs(d,{justify:"space-between",align:"center",gap:o.sm?"large":"small",wrap:!0,children:[s.jsx(t.Item,{name:"q_type",label:"Tipe Soal",rules:[{required:!0}],style:{flex:1},children:s.jsx(v,{onChange:e=>{L(e)},size:"large",children:I.map(e=>s.jsx(v.Option,{value:e.value,children:s.jsxs(p,{children:[e.icon,e.label]})},e.value))})}),s.jsx(t.Item,{name:"score_point",label:"Bobot Skor",rules:[{required:!0}],children:s.jsx(z,{min:1,style:{width:"100%"},size:"large"})})]}),s.jsx(_,{}),s.jsx(t.Item,{name:"content",label:s.jsx("span",{style:{fontSize:16,fontWeight:600},children:"Pertanyaan"}),rules:[{required:!0,message:"Tulis pertanyaan soal"}],children:s.jsx(h,{placeholder:"Tulis soal disini (Gunakan toolbar untuk insert gambar/rumus)...",height:"300px"})}),s.jsxs("div",{style:{background:"#fff",marginTop:40},children:[s.jsx(_,{titlePlacement:"left",style:{borderColor:"#eee"},children:"Kunci Jawaban & Opsi"}),(()=>{switch(f){case 1:return s.jsx(k,{form:x,isMulti:!1});case 2:return s.jsx(k,{form:x,isMulti:!0});case 3:return s.jsx(M,{title:"Tipe Soal Uraian",description:"Untuk tipe soal uraian (Essay), tidak ada kunci jawaban otomatis. Jawaban siswa akan diperiksa secara manual oleh guru.",type:"warning",showIcon:!0});case 4:return s.jsx(b,{});case 5:return s.jsx(C,{form:x});case 6:return s.jsx(y,{});default:return null}})()]}),s.jsx(_,{}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:12},children:[s.jsx(m,{onClick:n,disabled:B,size:"large",children:"Batal"}),s.jsx(m,{type:"primary",htmlType:"submit",icon:s.jsx(T,{size:18}),loading:B,size:"large",children:e?"Perbarui Soal":"Simpan Soal"})]})]})})};export{L as default};
