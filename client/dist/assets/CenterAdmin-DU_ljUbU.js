import{I as e,a,F as s,m as l,v as i,w as t,j as n,C as r,h as o,R as c,f as m,x as d,y as h,s as u,z as x,D as p,E as f,T as j,d as b,G as y,g,S as _,o as S,B as v,p as w,r as k,t as C,b as I}from"./index-CVvYH8o1.js";import{b as z}from"./vendor-BhwIo2T6.js";import{I as A}from"./InfiniteScrollList-9flDvJTp.js";import{a as L}from"./index-CAcyGMA9.js";import{S as P}from"./index-Bs_ywDJM.js";import{M as T}from"./index-DOzjnNTE.js";import{P as F}from"./index-C0MTcrq3.js";import{R as M}from"./DeleteOutlined-MFxqPosx.js";import"./index-N53jIs86.js";import"./ActionButton-BSwwgC9k.js";var O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M899.6 276.5L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.7-3.5-13.1 1.2-12.2 7.9L188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.8-6.7-6.5-11.4-12.3-7.9zM512 734.2c-62.1 0-112.6-50.5-112.6-112.6S449.9 509 512 509s112.6 50.5 112.6 112.6S574.1 734.2 512 734.2zm0-160.9c-26.6 0-48.2 21.6-48.2 48.3 0 26.6 21.6 48.3 48.2 48.3s48.2-21.6 48.2-48.3c0-26.6-21.6-48.3-48.2-48.3z"}}]},name:"crown",theme:"filled"};function B(){return B=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},B.apply(this,arguments)}const E=(a,s)=>z.createElement(e,B({},a,{ref:s,icon:O})),N=z.forwardRef(E),{Option:q}=L,W=e=>{const p=a.c(52),{open:f,onCancel:j,onSuccess:b,initialData:y}=e,[g]=s.useForm();let _;p[0]===Symbol.for("react.memo_cache_sentinel")?(_={page:1,limit:100},p[0]=_):_=p[0];const{data:S,isLoading:v}=l(_),[w,k]=i(),{isLoading:C}=k,[I,A]=t(),{isLoading:F}=A;let M,O,B;p[1]!==g||p[2]!==y||p[3]!==f?(M=()=>{f&&(y?g.setFieldsValue({...y,password:"",homebase_id:y.homebase_id||void 0}):g.resetFields())},O=[f,y,g],p[1]=g,p[2]=y,p[3]=f,p[4]=M,p[5]=O):(M=p[4],O=p[5]),z.useEffect(M,O),p[6]!==w||p[7]!==g||p[8]!==y||p[9]!==b||p[10]!==I?(B=async e=>{try{"satuan"!==e.level&&(e.homebase_id=null),y?(await I({id:y.id,...e}).unwrap(),u.success("Data admin diperbarui")):(await w(e).unwrap(),u.success("Admin baru ditambahkan")),g.resetFields(),b()}catch(a){const e=a;u.error(e?.data?.message||"Terjadi kesalahan")}},p[6]=w,p[7]=g,p[8]=y,p[9]=b,p[10]=I,p[11]=B):B=p[11];const E=B,N=y?"Edit Admin":"Tambah Admin Baru",W=C||F;let U,R,V;p[12]===Symbol.for("react.memo_cache_sentinel")?(U=[{required:!0,message:"Wajib diisi"}],p[12]=U):U=p[12],p[13]===Symbol.for("react.memo_cache_sentinel")?(R=n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"full_name",label:"Nama Lengkap",rules:U,children:n.jsx(o,{placeholder:"Nama Admin",prefix:n.jsx(c,{})})})}),p[13]=R):R=p[13],p[14]===Symbol.for("react.memo_cache_sentinel")?(V=[{required:!0,message:"Wajib diisi"}],p[14]=V):V=p[14];const G=!!y;let K,Y,J,Q,X,Z;p[15]!==G?(K=n.jsxs(m,{gutter:16,children:[R,n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"username",label:"Username",rules:V,children:n.jsx(o,{placeholder:"Username Login",disabled:G})})})]}),p[15]=G,p[16]=K):K=p[16],p[17]===Symbol.for("react.memo_cache_sentinel")?(Y=[{required:!0,message:"Pilih level akses"}],p[17]=Y):Y=p[17],p[18]===Symbol.for("react.memo_cache_sentinel")?(J=n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"level",label:"Level Akses",initialValue:"admin",rules:Y,children:n.jsxs(L,{placeholder:"Pilih Level",children:[n.jsx(q,{value:"pusat",children:"Pusat"}),n.jsx(q,{value:"satuan",children:"Satuan (Sekolah)"}),n.jsx(q,{value:"tahfiz",children:"Tahfiz"})]})})}),p[18]=J):J=p[18],p[19]===Symbol.for("react.memo_cache_sentinel")?(Q=n.jsxs(m,{gutter:16,children:[J,n.jsx(r,{span:12,children:n.jsx(s.Item,{name:"phone",label:"No. Telepon",children:n.jsx(o,{placeholder:"08xxx",prefix:n.jsx(d,{})})})})]}),p[19]=Q):Q=p[19],p[20]!==S?.data||p[21]!==v?(X=n.jsx(s.Item,{noStyle:!0,shouldUpdate:D,children:e=>{const{getFieldValue:a}=e;return"satuan"===a("level")?n.jsx(s.Item,{name:"homebase_id",label:"Pilih Satuan Pendidikan (Homebase)",rules:[{required:!0,message:"Admin Satuan wajib memilih Homebase!"}],children:n.jsx(L,{placeholder:"Pilih Homebase",loading:v,allowClear:!0,showSearch:!0,optionFilterProp:"children",children:S?.data?.map(H)})}):null}}),p[20]=S?.data,p[21]=v,p[22]=X):X=p[22],p[23]===Symbol.for("react.memo_cache_sentinel")?(Z=n.jsx(s.Item,{name:"email",label:"Email",children:n.jsx(o,{placeholder:"email@sekolah.com",prefix:n.jsx(h,{})})}),p[23]=Z):Z=p[23];const $=y?"Password Baru (Opsional)":"Password",ee=!y;let ae,se,le,ie;p[24]!==ee?(ae={required:ee,message:"Password wajib diisi untuk admin baru"},p[24]=ee,p[25]=ae):ae=p[25],p[26]===Symbol.for("react.memo_cache_sentinel")?(se={min:6,message:"Minimal 6 karakter"},p[26]=se):se=p[26],p[27]!==ae?(le=[ae,se],p[27]=ae,p[28]=le):le=p[28],p[29]===Symbol.for("react.memo_cache_sentinel")?(ie=n.jsx(x,{}),p[29]=ie):ie=p[29];const te=y?"Isi jika ingin mengganti password":"Password akun";let ne,re,oe,ce,me;return p[30]!==te?(ne=n.jsx(o.Password,{prefix:ie,placeholder:te}),p[30]=te,p[31]=ne):ne=p[31],p[32]!==$||p[33]!==le||p[34]!==ne?(re=n.jsx(s.Item,{name:"password",label:$,rules:le,children:ne}),p[32]=$,p[33]=le,p[34]=ne,p[35]=re):re=p[35],p[36]!==y?(oe=y&&n.jsx(s.Item,{name:"is_active",label:"Status Akun",valuePropName:"checked",children:n.jsx(P,{checkedChildren:"Aktif",unCheckedChildren:"Nonaktif"})}),p[36]=y,p[37]=oe):oe=p[37],p[38]!==g||p[39]!==E||p[40]!==K||p[41]!==X||p[42]!==re||p[43]!==oe?(ce=n.jsxs(s,{form:g,layout:"vertical",onFinish:E,children:[K,Q,X,Z,re,oe]}),p[38]=g,p[39]=E,p[40]=K,p[41]=X,p[42]=re,p[43]=oe,p[44]=ce):ce=p[44],p[45]!==g.submit||p[46]!==j||p[47]!==f||p[48]!==ce||p[49]!==N||p[50]!==W?(me=n.jsx(T,{title:N,open:f,onCancel:j,onOk:g.submit,confirmLoading:W,destroyOnHidden:!0,width:600,children:ce}),p[45]=g.submit,p[46]=j,p[47]=f,p[48]=ce,p[49]=N,p[50]=W,p[51]=me):me=p[51],me};function D(e,a){return e.level!==a.level}function H(e){return n.jsx(q,{value:e.id,children:e.name},e.id)}const{Title:U,Text:R}=j,V=()=>{const e=a.c(42),[s,l]=z.useState(1),[i,t]=z.useState("");let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=[],e[0]=r):r=e[0];const[m,d]=z.useState(r),[h,x]=z.useState(!1),[j,L]=z.useState(null);let P;e[1]!==s||e[2]!==i?(P={page:s,limit:10,search:i},e[1]=s,e[2]=i,e[3]=P):P=e[3];const{data:T,isFetching:O,refetch:B}=p(P),[E,q]=f(),{isLoading:D}=q;let H,V,K,Y,J;e[4]!==T||e[5]!==s?(H=()=>{T?.data&&d(1===s?T.data:e=>{const a=T.data.filter(a=>!e.some(e=>e.id===a.id));return[...e,...a]})},V=[T,s],e[4]=T,e[5]=s,e[6]=H,e[7]=V):(H=e[6],V=e[7]),z.useEffect(H,V),e[8]===Symbol.for("react.memo_cache_sentinel")?(K=()=>{l(1)},e[8]=K):K=e[8],e[9]!==i?(Y=[i],e[9]=i,e[10]=Y):Y=e[10],z.useEffect(K,Y),e[11]!==T?.hasMore||e[12]!==O?(J=()=>{T?.hasMore&&!O&&l(G)},e[11]=T?.hasMore,e[12]=O,e[13]=J):J=e[13];const Q=J;let X;e[14]===Symbol.for("react.memo_cache_sentinel")?(X=e=>{L(void 0===e?null:e),x(!0)},e[14]=X):X=e[14];const Z=X;let $;e[15]!==E||e[16]!==B?($=async e=>{try{await E(e).unwrap(),u.success("Admin berhasil dihapus"),l(1),B()}catch(a){u.error("Gagal menghapus admin")}},e[15]=E,e[16]=B,e[17]=$):$=e[17];const ee=$;let ae;e[18]!==B?(ae=()=>{x(!1),L(null),l(1),B()},e[18]=B,e[19]=ae):ae=e[19];const se=ae;let le;e[20]!==ee||e[21]!==D?(le=e=>{const a="center"===e.level;return n.jsx(b,{hoverable:!0,style:{height:"100%"},bodyStyle:{padding:"16px"},children:n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[n.jsxs("div",{style:{display:"flex",gap:12,flex:1,minWidth:0},children:[n.jsx(y,{size:48,icon:n.jsx(c,{}),style:{backgroundColor:a?"#faad14":"#1890ff",flexShrink:0}}),n.jsxs("div",{style:{minWidth:0,flex:1},children:[n.jsxs(U,{level:5,style:{margin:0,fontSize:15},ellipsis:!0,children:[e.full_name,a&&n.jsx(N,{style:{color:"#faad14",marginLeft:6}})]}),n.jsxs(R,{type:"secondary",style:{fontSize:12,display:"block"},ellipsis:{tooltip:e.username},children:["@",e.username]}),n.jsx(R,{type:"secondary",style:{fontSize:11,display:"block",color:"#aaa"},ellipsis:{tooltip:e.email},children:e.email||"-"}),n.jsxs("div",{style:{marginTop:8,display:"flex",gap:4,flexWrap:"wrap"},children:[n.jsx(g,{color:a?"gold":"blue",style:{margin:0,fontSize:10},children:e.level.toUpperCase()}),n.jsx(g,{color:e.is_active?"success":"error",style:{margin:0,fontSize:10},children:e.is_active?"AKTIF":"NONAKTIF"})]})]})]}),n.jsxs(_,{vertical:!0,size:0,children:[n.jsx(S,{title:"Edit",children:n.jsx(v,{type:"text",size:"small",icon:n.jsx(w,{style:{color:"orange"}}),onClick:()=>Z(e)})}),n.jsx(F,{title:"Hapus Admin?",onConfirm:()=>ee(e.id),disabled:a,okText:"Ya",cancelText:"Batal",children:n.jsx(v,{type:"text",size:"small",danger:!0,icon:n.jsx(M,{}),disabled:a,loading:D})})]})]})})},e[20]=ee,e[21]=D,e[22]=le):le=e[22];const ie=le;let te,ne,re,oe;e[23]===Symbol.for("react.memo_cache_sentinel")?(te={display:"flex",justifyContent:"space-between",marginBottom:16,gap:10},e[23]=te):te=e[23],e[24]===Symbol.for("react.memo_cache_sentinel")?(ne=n.jsx(k,{}),e[24]=ne):ne=e[24],e[25]===Symbol.for("react.memo_cache_sentinel")?(re=n.jsx(o,{placeholder:"Cari nama atau username...",prefix:ne,allowClear:!0,onChange:e=>t(e.target.value),style:{maxWidth:300}}),e[25]=re):re=e[25],e[26]===Symbol.for("react.memo_cache_sentinel")?(oe=n.jsxs("div",{style:te,children:[re,n.jsx(v,{type:"primary",icon:n.jsx(C,{}),onClick:()=>Z(null),children:"Tambah Admin"})]}),e[26]=oe):oe=e[26];const ce=T?.hasMore;let me,de,he,ue,xe;return e[27]===Symbol.for("react.memo_cache_sentinel")?(me={gutter:[16,16],xs:24,sm:12,md:12,lg:8,xl:6,xxl:6},e[27]=me):me=e[27],e[28]!==Q||e[29]!==O||e[30]!==m||e[31]!==ie||e[32]!==ce?(de=n.jsx(A,{data:m,loading:O,hasMore:ce,onLoadMore:Q,renderItem:ie,height:"75vh",emptyText:"Belum ada data admin",grid:me}),e[28]=Q,e[29]=O,e[30]=m,e[31]=ie,e[32]=ce,e[33]=de):de=e[33],e[34]===Symbol.for("react.memo_cache_sentinel")?(he=()=>x(!1),e[34]=he):he=e[34],e[35]!==j||e[36]!==se||e[37]!==h?(ue=n.jsx(W,{open:h,initialData:j,onCancel:he,onSuccess:se}),e[35]=j,e[36]=se,e[37]=h,e[38]=ue):ue=e[38],e[39]!==de||e[40]!==ue?(xe=n.jsxs(I,{title:"Manajemen Admin",children:[oe,de,ue]}),e[39]=de,e[40]=ue,e[41]=xe):xe=e[41],xe};function G(e){return e+1}export{V as default};
