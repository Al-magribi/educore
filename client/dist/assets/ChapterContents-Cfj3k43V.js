import{az as e,k as t,ax as s,b9 as a,eb as r,T as n,z as i,o as l,aL as o,s as d,X as c,B as m}from"./index-DJgzJvx0.js";import{r as p}from"./vendor-kOq7Q5-U.js";import{P as h,C as u,D as j}from"./dnd.esm-sGhUNbpo.js";import{Y as x,a as g,C as f}from"./YouTubePlayer-CTi5IBzn.js";import{E as b}from"./index-CsPvpU6M.js";import{G as y}from"./ChapterList-CAEK7Fim.js";import{T as _}from"./index-A8UrXWNV.js";import{P as v}from"./pencil-BHIqPcQ5.js";import{P as w}from"./index-C1pdE3N8.js";import{T as z}from"./trash-2-AcrYeN4V.js";import{D as k}from"./download-CnFHAq_0.js";import"./charts-4CCI6hAs.js";import"./index-CWRbA1GH.js";import"./ActionButton-DZkZ4UyV.js";import"./context-Co2t6AGx.js";import"./useMergedMask-hWGqm8nf.js";import"./useClosable-BMlLLbW6.js";import"./Collapse-D57cS8Q2.js";import"./plus-BlyBk2I3.js";const C=e("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),{Text:S}=n,P=e=>e?Array.isArray(e)?e.filter(Boolean):"string"==typeof e&&e?[e]:[]:[],$=e=>{const n=t.c(33),{chapterId:$,onEdit:T,onDelete:B}=e,I=!s.useBreakpoint().md;let R;n[0]!==$?(R={chapterId:$},n[0]=$,n[1]=R):R=n[1];const{data:E,isLoading:M}=a(R);let L;n[2]!==E?.data?(L=E?.data||[],n[2]=E?.data,n[3]=L):L=n[3];const H=L;let W;n[4]===Symbol.for("react.memo_cache_sentinel")?(W=[],n[4]=W):W=n[4];const[q,A]=p.useState(W),[F,G]=p.useState(!1),[V,U]=p.useState(""),[Y,J]=p.useState(""),[K]=r();let X;n[5]!==H?(X=[...H],X.sort(D),n[5]=H,n[6]=X):X=n[6];const N=X;let O,Q,Z;n[7]!==N?(O=()=>{A(N)},Q=[N],n[7]=N,n[8]=O,n[9]=Q):(O=n[8],Q=n[9]),p.useEffect(O,Q),n[10]!==q||n[11]!==K?(Z=async e=>{if(!e.destination)return;if(e.destination.index===e.source.index)return;const t=[...q],[s]=t.splice(e.source.index,1);t.splice(e.destination.index,0,s),A(t);try{await Promise.all(t.map((e,t)=>{const s=P(e.video_urls).length?P(e.video_urls):P(e.video_url),a=P(e.attachment_urls).length?P(e.attachment_urls):P(e.attachment_url),r=P(e.attachment_names).length?P(e.attachment_names):P(e.attachment_name);return K({id:e.id,title:e.title,body:e.body,video_urls:s,attachment_urls:a,attachment_names:r,video_url:s[0]||null,attachment_url:a[0]||null,attachment_name:r[0]||null,order_number:t+1}).unwrap()})),i.success("Urutan subbab diperbarui.")}catch(a){i.error("Gagal mengubah urutan subbab.")}},n[10]=q,n[11]=K,n[12]=Z):Z=n[12];const ee=Z;if(M){let e;return n[13]===Symbol.for("react.memo_cache_sentinel")?(e=l.jsx(S,{type:"secondary",children:"Memuat subbab..."}),n[13]=e):e=n[13],e}if(0===q.length){let e;return n[14]===Symbol.for("react.memo_cache_sentinel")?(e=l.jsx(b,{description:"Belum ada subbab."}),n[14]=e):e=n[14],e}let te,se;n[15]===Symbol.for("react.memo_cache_sentinel")?(te=()=>G(!1),n[15]=te):te=n[15],n[16]!==Y||n[17]!==V||n[18]!==F?(se=l.jsx(x,{open:F,onClose:te,videoUrl:V,title:Y}),n[16]=Y,n[17]=V,n[18]=F,n[19]=se):se=n[19];const ae=`contents-${$}`;let re,ne,ie;return n[20]!==$||n[21]!==q||n[22]!==I||n[23]!==B||n[24]!==T?(re=e=>l.jsxs("div",{ref:e.innerRef,...e.droppableProps,children:[l.jsx(o,{vertical:!0,gap:12,children:q.map((e,t)=>{const s=P(e.video_urls).length?P(e.video_urls):P(e.video_url),a=P(e.attachment_urls).length?P(e.attachment_urls):P(e.attachment_url),r=P(e.attachment_names).length?P(e.attachment_names):P(e.attachment_name);return l.jsx(h,{draggableId:`content-${e.id}`,index:t,children:t=>l.jsx("div",{ref:t.innerRef,...t.draggableProps,style:{...t.draggableProps.style},children:l.jsx(d,{size:"small",style:{borderRadius:12,borderColor:"#f0f0f0"},styles:{body:{padding:I?12:16}},children:l.jsxs(o,{vertical:!0,gap:12,children:[l.jsxs(o,{align:"flex-start",justify:"space-between",wrap:"wrap",gap:10,children:[l.jsxs(o,{align:"center",gap:8,style:{minWidth:0,flex:1},wrap:"wrap",children:[l.jsx("span",{...t.dragHandleProps,style:{display:"inline-flex",alignItems:"center",color:"#8c8c8c",cursor:"grab",marginTop:2},children:l.jsx(y,{size:14})}),l.jsx(S,{strong:!0,style:{fontSize:14,maxWidth:I?"100%":"68%"},ellipsis:{tooltip:e.title},children:e.title}),s.length>0?l.jsxs(_,{color:"red",icon:l.jsx(g,{size:12}),style:{marginRight:0,cursor:"pointer"},onClick:()=>{U(s[0]),J(e.title),G(!0)},children:["Video ",s.length]}):null,a.length>0?l.jsxs(_,{color:"blue",icon:l.jsx(C,{size:12}),style:{marginRight:0,cursor:"pointer"},onClick:()=>window.open(a[0],"_blank","noreferrer"),children:["File ",a.length]}):null]}),l.jsxs(c,{size:8,wrap:!0,children:[l.jsx(m,{size:I?"middle":"small",icon:l.jsx(v,{size:14}),onClick:()=>T(e,$),children:"Edit"}),l.jsx(w,{title:"Hapus subbab ini?",onConfirm:()=>B(e.id),children:l.jsx(m,{size:I?"middle":"small",danger:!0,icon:l.jsx(z,{size:14}),children:"Hapus"})})]})]}),e.body?l.jsx("div",{style:{background:"#fafafa",border:"1px solid #f0f0f0",borderRadius:10,padding:I?10:12},dangerouslySetInnerHTML:{__html:e.body}}):l.jsx(S,{type:"secondary",children:"Tanpa deskripsi."}),(s.length>0||a.length>0)&&l.jsxs(o,{vertical:!0,gap:10,children:[s.length>0?l.jsxs(o,{vertical:!0,gap:6,children:[l.jsx(S,{type:"secondary",style:{fontSize:12},children:"Video Pembelajaran"}),l.jsx(c,{size:8,wrap:!0,children:s.map((t,s)=>l.jsxs(m,{size:I?"middle":"small",type:"primary",ghost:!0,icon:l.jsx(f,{size:14}),style:I?{flex:1,minWidth:140}:void 0,onClick:()=>{U(t),J(`${e.title} (${s+1})`),G(!0)},children:["Putar Video ",s+1]},`play-${e.id}-${s}`))})]}):null,a.length>0?l.jsxs(o,{vertical:!0,gap:6,children:[l.jsx(S,{type:"secondary",style:{fontSize:12},children:"File Lampiran"}),l.jsx(c,{size:8,wrap:!0,children:a.map((t,s)=>l.jsx(m,{size:I?"middle":"small",icon:l.jsx(k,{size:14}),href:t,target:"_blank",rel:"noreferrer",download:!0,style:I?{flex:1,minWidth:170}:void 0,children:r[s]?`Download ${r[s]}`:`Download File ${s+1}`},`download-${e.id}-${s}`))})]}):null]})]})})})},e.id)})}),e.placeholder]}),n[20]=$,n[21]=q,n[22]=I,n[23]=B,n[24]=T,n[25]=re):re=n[25],n[26]!==re||n[27]!==ae?(ne=l.jsx(u,{droppableId:ae,type:"content",children:re}),n[26]=re,n[27]=ae,n[28]=ne):ne=n[28],n[29]!==ee||n[30]!==ne||n[31]!==se?(ie=l.jsxs(j,{onDragEnd:ee,children:[se,ne]}),n[29]=ee,n[30]=ne,n[31]=se,n[32]=ie):ie=n[32],ie};function D(e,t){const s=e.order_number??9999,a=t.order_number??9999;return s!==a?s-a:new Date(e.created_at)-new Date(t.created_at)}export{$ as default};
