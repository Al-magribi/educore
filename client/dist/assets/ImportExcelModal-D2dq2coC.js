import{m as e}from"./charts-DyIopC3t.js";import{aR as t,k as a,o as i,dP as o,T as s,B as n,Y as r,D as l}from"./index-IfHJv5WL.js";import{r as d}from"./vendor-kOq7Q5-U.js";import{A as c}from"./index-Ck6zxCm-.js";import{F as p}from"./Table-ClpUx-_a.js";import{M as h}from"./index-CQKi3m8Y.js";import{U as m}from"./index-DhFg-b_f.js";import{P as u}from"./progress-Djso4M81.js";import{D as x}from"./download-CZEAt8BA.js";import"./index-CPaPbrqg.js";import"./index-BSxM1sbQ.js";import"./index-bEkSGdHP.js";import"./index-BM57nN4D.js";import"./ActionButton-CwPtgC52.js";import"./DeleteOutlined-BgrfJ2kJ.js";const y=t("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),_=t("file-spreadsheet",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),k=t("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),f=async()=>{const t=await e(()=>import("./xlsx-3FAc2Sll.js"),[]),a=t.utils.json_to_sheet([{type_id:1,question_text:"Perhatikan ciri-ciri bangun ruang: a. Memiliki 6 sisi sama besar... Bangun tersebut adalah? [cite: 15]",score_point:2,option_a:"Kubus",option_b:"Balok",option_c:"Limas",option_d:"Prisma",option_e:"",key:"A"},{type_id:4,question_text:"Banyak titik sudut pada bola adalah... [cite: 159]",score_point:5,option_a:"",option_b:"",option_c:"",option_d:"",option_e:"",key:"0, Kosong"},{type_id:6,question_text:"Pasangkan koordinat titik asal dengan hasil translasinya! ",score_point:10,option_a:"A(3,-2) trans (-4,5) | (-1,3)",option_b:"B(-6,3) refl sumbu Y | (6,3)",option_c:"C(4,1) dilat [0,2] | (8,2)",option_d:"",option_e:"",key:""}]),i=t.utils.book_new();t.utils.book_append_sheet(i,a,"Template Soal"),a["!cols"]=[{wch:10},{wch:50},{wch:12},{wch:25},{wch:25},{wch:25},{wch:25},{wch:25},{wch:20}],t.writeFile(i,"Template_Soal_CBT.xlsx")},j=()=>{const e=a.c(4);let t,o,s,n;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t={marginBottom:20},e[0]=t):t=e[0],e[1]===Symbol.for("react.memo_cache_sentinel")?(o=i.jsx(k,{size:18}),s={overflowX:"auto",WebkitOverflowScrolling:"touch"},e[1]=o,e[2]=s):(o=e[1],s=e[2]),e[3]===Symbol.for("react.memo_cache_sentinel")?(n=i.jsx("div",{style:t,children:i.jsx(c,{title:"Aturan Pengisian Excel",type:"info",showIcon:!0,icon:o,description:i.jsx("div",{style:s,children:i.jsx(p,{size:"small",pagination:!1,bordered:!0,scroll:{x:360},style:{marginTop:10,minWidth:"360px"},dataSource:[{id:1,tipe:"PG",key:"Huruf (A/B/C)"},{id:4,tipe:"Isian",key:"Jawaban (10, Sepuluh)"},{id:5,tipe:"B/S",key:"Tulis 'Benar'/'Salah'"},{id:6,tipe:"Jodoh",key:"Sisi Kiri | Sisi Ranan"},{id:3,tipe:"Uraian",key:"-"}],columns:[{title:"ID",dataIndex:"id",key:"id",width:50},{title:"Jenis",dataIndex:"tipe",key:"tipe",width:80},{title:"Isi Kolom Key / Option",dataIndex:"key",key:"key"}]})})})}),e[3]=n):n=e[3],n},{Dragger:g}=m,{Text:w}=s,b=({visible:t,onCancel:a,bankId:s,onSuccess:c})=>{const[p,m]=d.useState(!1),[k,b]=d.useState(!1),[S]=o();d.useEffect(()=>{const e=()=>b(window.innerWidth<=480);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);return i.jsxs(h,{centered:!0,title:i.jsxs(r,{children:[i.jsx(_,{size:20,color:"#1890ff"}),i.jsx("span",{children:"Bulk Import Soal"})]}),open:t,onCancel:a,width:k?"92vw":700,footer:i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,justifyContent:"flex-end"},children:[i.jsx(n,{onClick:a,disabled:p,block:k,children:"Batal"},"cancel"),i.jsx(n,{icon:i.jsx(x,{size:16}),onClick:f,disabled:p,block:k,children:"Unduh Template"},"dl")]}),children:[i.jsx(j,{}),i.jsx("div",{style:{marginTop:20},children:i.jsxs(g,{accept:".xlsx, .xls",beforeUpload:t=>{m(!0);const a=new FileReader;return a.onload=async t=>{try{const a=await e(()=>import("./xlsx-3FAc2Sll.js"),[]),i=t.target.result,o=a.read(i,{type:"binary"}),n=o.Sheets[o.SheetNames[0]],r=a.utils.sheet_to_json(n);if(0===r.length)throw new Error("File Excel kosong atau format tidak sesuai.");const d=r.map(e=>{const t=parseInt(e.type_id);let a=[];return[1,2].includes(t)?["a","b","c","d","e"].forEach(t=>{e[`option_${t}`]&&a.push({label:t.toUpperCase(),content:e[`option_${t}`],is_correct:e.key?.toString().toUpperCase().includes(t.toUpperCase())})}):4===t?a=(e.key?.toString().split(",")||[]).map(e=>({content:e.trim(),is_correct:!0})):5===t?a=[{content:"Benar",is_correct:"benar"===e.key?.toString().toLowerCase()},{content:"Salah",is_correct:"salah"===e.key?.toString().toLowerCase()}]:6===t&&["a","b","c","d","e"].forEach(t=>{const i=e[`option_${t}`];if(i&&i.includes("|")){const[e,t]=i.split("|").map(e=>e.trim());a.push({label:e,content:t,is_correct:!0})}}),{bank_soal_id:s,q_type:t,content:e.question_text,score_point:parseInt(e.score_point)||1,options:a}});await S(d).unwrap(),l.success(`${r.length} soal berhasil diunggah.`),c()}catch(a){console.error("Import Error:",a),l.error(a.data?.message||a.message||"Gagal memproses file.")}finally{m(!1)}},a.readAsArrayBuffer(t),!1},showUploadList:!1,disabled:p,style:{padding:k?"12px":"24px"},children:[i.jsx("p",{className:"ant-upload-drag-icon",children:i.jsx(y,{size:48,color:p?"#d9d9d9":"#40a9ff"})}),i.jsx("p",{className:"ant-upload-text",children:p?"Sedang memproses data...":"Klik atau seret file Excel ke sini"}),i.jsx("p",{className:"ant-upload-hint",children:"Hanya mendukung file .xlsx atau .xls sesuai template sistem."})]})}),p&&i.jsxs("div",{style:{marginTop:20,textAlign:"center"},children:[i.jsx(u,{percent:99,status:"active",strokeColor:"#1890ff"}),i.jsx(w,{type:"secondary",children:"Mengirim data ke server, mohon tunggu..."})]})]})};export{b as default};
