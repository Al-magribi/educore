import{k as e,eB as a,o as r,s as t,T as i,X as s,aL as n,B as l}from"./index-DJgzJvx0.js";import"./vendor-kOq7Q5-U.js";import{utils as o,writeFile as d}from"./xlsx-3FAc2Sll.js";import{S as c}from"./index-ZAZRIL-n.js";import{A as m}from"./index-D-YBaVh2.js";import{E as u}from"./index-CsPvpU6M.js";import{F as p}from"./Table-Bpp4NRb8.js";import{T as g}from"./index-A8UrXWNV.js";import{F as h}from"./funnel-CQS6Mpx9.js";import{R as _}from"./refresh-ccw-CYu9ftZ8.js";import{D as f}from"./download-CnFHAq_0.js";import{U as j}from"./users-DP4QiVnj.js";import"./charts-4CCI6hAs.js";import"./index-Bjno29EH.js";import"./index-BzygXUWO.js";import"./useClosable-BMlLLbW6.js";const{Title:x,Text:v}=i,y=e=>Math.round(100*Number(e||0))/100,b=i=>{const b=e.c(106),{isActive:T,subjectId:C,subject:z,activePeriode:P,classes:B,classLoading:F,classId:L,setClassId:W,semester:$,setSemester:D,isAdminView:E,teacherId:K,setTeacherId:M,teachers:U,teacherLoading:V,screens:X}=i,q=void 0!==E&&E;let G;b[0]!==U?(G=void 0===U?[]:U,b[0]=U,b[1]=G):G=b[1];const H=G,J=void 0!==V&&V;let O;b[2]!==L||b[3]!==$||b[4]!==C||b[5]!==K?(O={subjectId:C,classId:L,semester:$,teacherId:K},b[2]=L,b[3]=$,b[4]=C,b[5]=K,b[6]=O):O=b[6];const Q=!T||!C||!L||!$||q&&!K;let Y;b[7]!==Q?(Y={skip:Q},b[7]=Q,b[8]=Y):Y=b[8];const{data:Z,isFetching:ee,refetch:ae}=a(O,Y);let re;b[9]!==Z?.data?(re=Z?.data||{},b[9]=Z?.data,b[10]=re):re=b[10];const te=re;let ie;b[11]!==te?.summary?(ie=te?.summary||{},b[11]=te?.summary,b[12]=ie):ie=b[12];const se=ie;let ne;b[13]!==te?.students?(ne=te?.students||[],b[13]=te?.students,b[14]=ne):ne=b[14];const le=ne;let oe;b[15]!==le?(oe=le.map(w),b[15]=le,b[16]=oe):oe=b[16];const de=oe;let ce;b[17]===Symbol.for("react.memo_cache_sentinel")?(ce=[{title:"No",dataIndex:"no",width:64,align:"center"},{title:"NIS",dataIndex:"nis",width:120},{title:"Nama Siswa",dataIndex:"full_name",ellipsis:!0,render:S},{title:"Rata-rata Sumatif",dataIndex:"summative_average",width:150,align:"center",render:k},{title:"Nilai Akhir",dataIndex:"final_grade",width:130,align:"center",render:N},{title:"Nilai Raport",dataIndex:"report_grade",width:130,align:"center",render:I}],b[17]=ce):ce=b[17];const me=ce;let ue;b[18]!==L||b[19]!==B||b[20]!==de||b[21]!==$?(ue=()=>{if(!de.length)return;const e=(e=>e.map(e=>({No:e.no,NIS:e.nis,"Nama Siswa":e.full_name,"Rata-rata Sumatif":e.summative_average??"-","Nilai Akhir":e.final_grade??"-","Nilai Raport":e.report_grade??"-"})))(de),a=o.json_to_sheet(e),r=o.book_new();o.book_append_sheet(r,a,"Rekap Nilai Raport");const t=`Rekap_Nilai_Raport_${B.find(e=>String(e.id)===String(L))?.name||"Kelas"}_Semester${$}`.replace(/[\\/:*?"<>|]/g,"-");d(r,`${t}.xlsx`)},b[18]=L,b[19]=B,b[20]=de,b[21]=$,b[22]=ue):ue=b[22];const pe=ue;let ge,he,_e;b[23]===Symbol.for("react.memo_cache_sentinel")?(ge={borderRadius:16},he={body:{padding:20}},b[23]=ge,b[24]=he):(ge=b[23],he=b[24]),b[25]===Symbol.for("react.memo_cache_sentinel")?(_e=r.jsxs(s,{vertical:!0,size:2,children:[r.jsx(x,{level:5,style:{margin:0},children:"Rekapitulasi Nilai Raport"}),r.jsx(v,{type:"secondary",children:"Nilai raport = rata-rata dari nilai sumatif dan nilai akhir"})]}),b[25]=_e):_e=b[25];const fe=z?.name||"Mata Pelajaran";let je;b[26]!==fe?(je=r.jsx(g,{color:"blue",children:fe}),b[26]=fe,b[27]=je):je=b[27];const xe=P?.name||te?.meta?.periode_name||"Periode";let ve,ye,be,we,Se,ke,Ne,Ie,Re,Ae,Te,Ce,ze,Pe,Be;b[28]!==xe?(ve=r.jsx(g,{color:"processing",children:xe}),b[28]=xe,b[29]=ve):ve=b[29],b[30]!==je||b[31]!==ve?(ye=r.jsxs(n,{justify:"space-between",align:"center",wrap:"wrap",gap:12,children:[_e,r.jsxs(s,{wrap:!0,children:[je,ve]})]}),b[30]=je,b[31]=ve,b[32]=ye):ye=b[32],b[33]===Symbol.for("react.memo_cache_sentinel")?(be={marginTop:16},b[33]=be):be=b[33],b[34]===Symbol.for("react.memo_cache_sentinel")?(we={minWidth:160},Se=[{value:1,label:"Semester 1"},{value:2,label:"Semester 2"}],ke=r.jsx(h,{size:14}),b[34]=we,b[35]=Se,b[36]=ke):(we=b[34],Se=b[35],ke=b[36]),b[37]!==$||b[38]!==D?(Ne=r.jsx(c,{value:$,onChange:D,style:we,options:Se,suffixIcon:ke}),b[37]=$,b[38]=D,b[39]=Ne):Ne=b[39],b[40]!==q||b[41]!==M||b[42]!==K||b[43]!==J||b[44]!==H?(Ie=q&&r.jsx(c,{value:K,onChange:M,style:{minWidth:220},placeholder:"Pilih guru",options:H.map(R),loading:J}),b[40]=q,b[41]=M,b[42]=K,b[43]=J,b[44]=H,b[45]=Ie):Ie=b[45],b[46]===Symbol.for("react.memo_cache_sentinel")?(Re={minWidth:220},b[46]=Re):Re=b[46],b[47]!==B?(Ae=B.map(A),b[47]=B,b[48]=Ae):Ae=b[48],b[49]!==L||b[50]!==F||b[51]!==W||b[52]!==Ae?(Te=r.jsx(c,{value:L,onChange:W,style:Re,placeholder:"Pilih kelas",options:Ae,loading:F}),b[49]=L,b[50]=F,b[51]=W,b[52]=Ae,b[53]=Te):Te=b[53],b[54]!==Ne||b[55]!==Ie||b[56]!==Te?(Ce=r.jsxs(s,{wrap:!0,children:[Ne,Ie,Te]}),b[54]=Ne,b[55]=Ie,b[56]=Te,b[57]=Ce):Ce=b[57],b[58]===Symbol.for("react.memo_cache_sentinel")?(ze=r.jsx(_,{size:14}),b[58]=ze):ze=b[58],b[59]!==ae?(Pe=r.jsx(l,{icon:ze,onClick:ae,children:"Refresh"}),b[59]=ae,b[60]=Pe):Pe=b[60],b[61]===Symbol.for("react.memo_cache_sentinel")?(Be=r.jsx(f,{size:14}),b[61]=Be):Be=b[61];const Fe=!de.length;let Le,We,$e,De,Ee;b[62]!==pe||b[63]!==Fe?(Le=r.jsx(l,{type:"primary",icon:Be,disabled:Fe,onClick:pe,children:"Download Excel"}),b[62]=pe,b[63]=Fe,b[64]=Le):Le=b[64],b[65]!==Pe||b[66]!==Le?(We=r.jsxs(s,{wrap:!0,children:[Pe,Le]}),b[65]=Pe,b[66]=Le,b[67]=We):We=b[67],b[68]!==Ce||b[69]!==We?($e=r.jsxs(n,{justify:"space-between",align:"center",wrap:"wrap",gap:12,style:be,children:[Ce,We]}),b[68]=Ce,b[69]=We,b[70]=$e):$e=b[70],b[71]===Symbol.for("react.memo_cache_sentinel")?(De={marginTop:14},b[71]=De):De=b[71],b[72]===Symbol.for("react.memo_cache_sentinel")?(Ee=r.jsx(j,{size:12}),b[72]=Ee):Ee=b[72];const Ke=te?.meta?.total_students||0;let Me,Ue,Ve,Xe,qe,Ge,He,Je,Oe,Qe,Ye;return b[73]!==Ke?(Me=r.jsxs(g,{color:"geekblue",icon:Ee,children:["Total Siswa: ",Ke]}),b[73]=Ke,b[74]=Me):Me=b[74],b[75]!==se.summative_average?(Ue=y(se.summative_average),b[75]=se.summative_average,b[76]=Ue):Ue=b[76],b[77]!==Ue?(Ve=r.jsxs(g,{color:"cyan",children:["Avg Sumatif: ",Ue]}),b[77]=Ue,b[78]=Ve):Ve=b[78],b[79]!==se.final_average?(Xe=y(se.final_average),b[79]=se.final_average,b[80]=Xe):Xe=b[80],b[81]!==Xe?(qe=r.jsxs(g,{color:"blue",children:["Avg Nilai Akhir: ",Xe]}),b[81]=Xe,b[82]=qe):qe=b[82],b[83]!==se.report_average?(Ge=y(se.report_average),b[83]=se.report_average,b[84]=Ge):Ge=b[84],b[85]!==Ge?(He=r.jsxs(g,{color:"green",children:["Avg Nilai Raport: ",Ge]}),b[85]=Ge,b[86]=He):He=b[86],b[87]!==Me||b[88]!==Ve||b[89]!==qe||b[90]!==He?(Je=r.jsxs(n,{wrap:"wrap",gap:8,style:De,children:[Me,Ve,qe,He]}),b[87]=Me,b[88]=Ve,b[89]=qe,b[90]=He,b[91]=Je):Je=b[91],b[92]!==ye||b[93]!==$e||b[94]!==Je?(Oe=r.jsxs(t,{style:ge,styles:he,children:[ye,$e,Je]}),b[92]=ye,b[93]=$e,b[94]=Je,b[95]=Oe):Oe=b[95],b[96]!==L||b[97]!==q||b[98]!==ee||b[99]!==de||b[100]!==X||b[101]!==K?(Qe=L?q&&!K?r.jsx(m,{type:"info",showIcon:!0,message:"Pilih guru pengampu untuk menampilkan data yang sesuai tampilan guru."}):r.jsx(t,{style:{borderRadius:16},styles:{body:{padding:0}},children:ee||de.length?r.jsx(p,{rowKey:"key",dataSource:de,columns:me,loading:ee,pagination:!1,size:X.xs?"small":"middle",tableLayout:"fixed"}):r.jsx("div",{style:{padding:24},children:r.jsx(u,{description:"Belum ada data nilai raport pada filter ini."})})}):r.jsx(m,{type:"info",showIcon:!0,message:"Pilih kelas untuk menampilkan rekap nilai raport."}),b[96]=L,b[97]=q,b[98]=ee,b[99]=de,b[100]=X,b[101]=K,b[102]=Qe):Qe=b[102],b[103]!==Oe||b[104]!==Qe?(Ye=r.jsxs(n,{vertical:!0,gap:16,children:[Oe,Qe]}),b[103]=Oe,b[104]=Qe,b[105]=Ye):Ye=b[105],Ye};function w(e,a){return{key:e.student_id,no:a+1,nis:e.nis||"-",full_name:e.full_name,summative_average:null===e.summative_average||void 0===e.summative_average?null:Number(e.summative_average),final_grade:null===e.final_grade||void 0===e.final_grade?null:Number(e.final_grade),report_grade:null===e.report_grade||void 0===e.report_grade?null:Number(e.report_grade)}}function S(e){return r.jsx(v,{strong:!0,children:e})}function k(e){return null==e?"-":r.jsx(g,{color:"cyan",children:y(e)})}function N(e){return null==e?"-":r.jsx(g,{color:"blue",children:y(e)})}function I(e){return null==e?"-":r.jsx(g,{color:"green",children:y(e)})}function R(e){return{value:e.id,label:e.full_name}}function A(e){return{value:e.id,label:e.name}}export{b as default};
