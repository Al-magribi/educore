import{k as e,eA as a,o as s,s as i,T as n,X as t,aL as l,B as r}from"./index-DJgzJvx0.js";import"./vendor-kOq7Q5-U.js";import{utils as o,writeFile as c}from"./xlsx-3FAc2Sll.js";import{S as d}from"./index-ZAZRIL-n.js";import{A as m}from"./index-D-YBaVh2.js";import{E as h}from"./index-CsPvpU6M.js";import{F as p}from"./Table-Bpp4NRb8.js";import{T as u}from"./index-A8UrXWNV.js";import{F as f}from"./funnel-CQS6Mpx9.js";import{R as x}from"./refresh-ccw-CYu9ftZ8.js";import{D as j}from"./download-CnFHAq_0.js";import{U as g}from"./users-DP4QiVnj.js";import"./charts-4CCI6hAs.js";import"./index-Bjno29EH.js";import"./index-BzygXUWO.js";import"./useClosable-BMlLLbW6.js";const{Title:_,Text:y}=n,b=e=>Math.round(100*Number(e||0))/100,k=n=>{const k=e.c(99),{isActive:A,subjectId:T,subject:C,activePeriode:R,classes:z,classLoading:P,classId:F,setClassId:B,semester:D,setSemester:L,isAdminView:W,teacherId:$,setTeacherId:E,teachers:K,teacherLoading:M,screens:U}=n,V=void 0!==W&&W;let X;k[0]!==K?(X=void 0===K?[]:K,k[0]=K,k[1]=X):X=k[1];const q=X,G=void 0!==M&&M;let H;k[2]!==F||k[3]!==D||k[4]!==T||k[5]!==$?(H={subjectId:T,classId:F,semester:D,teacherId:$},k[2]=F,k[3]=D,k[4]=T,k[5]=$,k[6]=H):H=k[6];const J=!A||!T||!F||!D||V&&!$;let O;k[7]!==J?(O={skip:J},k[7]=J,k[8]=O):O=k[8];const{data:Q,isFetching:Y,refetch:Z}=a(H,O);let ee;k[9]!==Q?.data?(ee=Q?.data||{},k[9]=Q?.data,k[10]=ee):ee=k[10];const ae=ee;let se;k[11]!==ae?.summary?(se=ae?.summary||{},k[11]=ae?.summary,k[12]=se):se=k[12];const ie=se;let ne;k[13]!==ae?.students?(ne=ae?.students||[],k[13]=ae?.students,k[14]=ne):ne=k[14];const te=ne;let le;k[15]!==te?(le=te.map(w),k[15]=te,k[16]=le):le=k[16];const re=le;let oe;k[17]===Symbol.for("react.memo_cache_sentinel")?(oe=[{title:"No",dataIndex:"no",width:64,align:"center",fixed:"left"},{title:"NIS",dataIndex:"nis",width:120,fixed:"left"},{title:"Nama Siswa",dataIndex:"full_name",width:240,fixed:"left",render:S},{title:"Nilai Akhir",dataIndex:"final_grade",width:140,align:"center",render:v}],k[17]=oe):oe=k[17];const ce=oe;let de;k[18]!==F||k[19]!==z||k[20]!==re||k[21]!==D?(de=()=>{if(!re.length)return;const e=(e=>e.map(e=>({No:e.no,NIS:e.nis,"Nama Siswa":e.full_name,"Nilai Akhir":e.final_grade??"-"})))(re),a=o.json_to_sheet(e),s=o.book_new();o.book_append_sheet(s,a,"Rekap Nilai Akhir");const i=`Rekap_Nilai_Akhir_${z.find(e=>String(e.id)===String(F))?.name||"Kelas"}_Semester${D}`.replace(/[\\/:*?"<>|]/g,"-");c(s,`${i}.xlsx`)},k[18]=F,k[19]=z,k[20]=re,k[21]=D,k[22]=de):de=k[22];const me=de;let he,pe,ue;k[23]===Symbol.for("react.memo_cache_sentinel")?(he={borderRadius:16},pe={body:{padding:20}},k[23]=he,k[24]=pe):(he=k[23],pe=k[24]),k[25]===Symbol.for("react.memo_cache_sentinel")?(ue=s.jsxs(t,{vertical:!0,size:2,children:[s.jsx(_,{level:5,style:{margin:0},children:"Rekapitulasi Nilai Akhir"}),s.jsx(y,{type:"secondary",children:"Rekap nilai akhir siswa dalam satu semester"})]}),k[25]=ue):ue=k[25];const fe=C?.name||"Mata Pelajaran";let xe;k[26]!==fe?(xe=s.jsx(u,{color:"blue",children:fe}),k[26]=fe,k[27]=xe):xe=k[27];const je=R?.name||ae?.meta?.periode_name||"Periode";let ge,_e,ye,be,ke,we,Se,ve,Ie,Ne,Ae,Te,Ce,Re,ze;k[28]!==je?(ge=s.jsx(u,{color:"processing",children:je}),k[28]=je,k[29]=ge):ge=k[29],k[30]!==xe||k[31]!==ge?(_e=s.jsxs(l,{justify:"space-between",align:"center",wrap:"wrap",gap:12,children:[ue,s.jsxs(t,{wrap:!0,children:[xe,ge]})]}),k[30]=xe,k[31]=ge,k[32]=_e):_e=k[32],k[33]===Symbol.for("react.memo_cache_sentinel")?(ye={marginTop:16},k[33]=ye):ye=k[33],k[34]===Symbol.for("react.memo_cache_sentinel")?(be={minWidth:160},ke=[{value:1,label:"Semester 1"},{value:2,label:"Semester 2"}],we=s.jsx(f,{size:14}),k[34]=be,k[35]=ke,k[36]=we):(be=k[34],ke=k[35],we=k[36]),k[37]!==D||k[38]!==L?(Se=s.jsx(d,{value:D,onChange:L,style:be,options:ke,suffixIcon:we}),k[37]=D,k[38]=L,k[39]=Se):Se=k[39],k[40]!==V||k[41]!==E||k[42]!==$||k[43]!==G||k[44]!==q?(ve=V&&s.jsx(d,{value:$,onChange:E,style:{minWidth:220},placeholder:"Pilih guru",options:q.map(I),loading:G}),k[40]=V,k[41]=E,k[42]=$,k[43]=G,k[44]=q,k[45]=ve):ve=k[45],k[46]===Symbol.for("react.memo_cache_sentinel")?(Ie={minWidth:220},k[46]=Ie):Ie=k[46],k[47]!==z?(Ne=z.map(N),k[47]=z,k[48]=Ne):Ne=k[48],k[49]!==F||k[50]!==P||k[51]!==B||k[52]!==Ne?(Ae=s.jsx(d,{value:F,onChange:B,style:Ie,placeholder:"Pilih kelas",options:Ne,loading:P}),k[49]=F,k[50]=P,k[51]=B,k[52]=Ne,k[53]=Ae):Ae=k[53],k[54]!==Se||k[55]!==ve||k[56]!==Ae?(Te=s.jsxs(t,{wrap:!0,children:[Se,ve,Ae]}),k[54]=Se,k[55]=ve,k[56]=Ae,k[57]=Te):Te=k[57],k[58]===Symbol.for("react.memo_cache_sentinel")?(Ce=s.jsx(x,{size:14}),k[58]=Ce):Ce=k[58],k[59]!==Z?(Re=s.jsx(r,{icon:Ce,onClick:Z,children:"Refresh"}),k[59]=Z,k[60]=Re):Re=k[60],k[61]===Symbol.for("react.memo_cache_sentinel")?(ze=s.jsx(j,{size:14}),k[61]=ze):ze=k[61];const Pe=!re.length;let Fe,Be,De,Le,We;k[62]!==me||k[63]!==Pe?(Fe=s.jsx(r,{type:"primary",icon:ze,disabled:Pe,onClick:me,children:"Download Excel"}),k[62]=me,k[63]=Pe,k[64]=Fe):Fe=k[64],k[65]!==Re||k[66]!==Fe?(Be=s.jsxs(t,{wrap:!0,children:[Re,Fe]}),k[65]=Re,k[66]=Fe,k[67]=Be):Be=k[67],k[68]!==Te||k[69]!==Be?(De=s.jsxs(l,{justify:"space-between",align:"center",wrap:"wrap",gap:12,style:ye,children:[Te,Be]}),k[68]=Te,k[69]=Be,k[70]=De):De=k[70],k[71]===Symbol.for("react.memo_cache_sentinel")?(Le={marginTop:14},k[71]=Le):Le=k[71],k[72]===Symbol.for("react.memo_cache_sentinel")?(We=s.jsx(g,{size:12}),k[72]=We):We=k[72];const $e=ae?.meta?.total_students||0;let Ee,Ke,Me;k[73]!==$e?(Ee=s.jsxs(u,{color:"geekblue",icon:We,children:["Total Siswa: ",$e]}),k[73]=$e,k[74]=Ee):Ee=k[74],k[75]!==ie.final_average?(Ke=b(ie.final_average),k[75]=ie.final_average,k[76]=Ke):Ke=k[76],k[77]!==Ke?(Me=s.jsxs(u,{color:"cyan",children:["Avg Nilai Akhir: ",Ke]}),k[77]=Ke,k[78]=Me):Me=k[78];const Ue=ie.total_graded||0;let Ve,Xe,qe,Ge,He;return k[79]!==Ue?(Ve=s.jsxs(u,{color:"purple",children:["Sudah Dinilai: ",Ue]}),k[79]=Ue,k[80]=Ve):Ve=k[80],k[81]!==Ee||k[82]!==Me||k[83]!==Ve?(Xe=s.jsxs(l,{wrap:"wrap",gap:8,style:Le,children:[Ee,Me,Ve]}),k[81]=Ee,k[82]=Me,k[83]=Ve,k[84]=Xe):Xe=k[84],k[85]!==_e||k[86]!==De||k[87]!==Xe?(qe=s.jsxs(i,{style:he,styles:pe,children:[_e,De,Xe]}),k[85]=_e,k[86]=De,k[87]=Xe,k[88]=qe):qe=k[88],k[89]!==F||k[90]!==V||k[91]!==Y||k[92]!==re||k[93]!==U||k[94]!==$?(Ge=F?V&&!$?s.jsx(m,{type:"info",showIcon:!0,message:"Pilih guru pengampu untuk menampilkan data yang sesuai tampilan guru."}):s.jsx(i,{style:{borderRadius:16},styles:{body:{padding:0}},children:Y||re.length?s.jsx(p,{rowKey:"key",dataSource:re,columns:ce,loading:Y,pagination:!1,size:U.xs?"small":"middle",scroll:{x:1200},sticky:!0}):s.jsx("div",{style:{padding:24},children:s.jsx(h,{description:"Belum ada data nilai akhir pada filter ini."})})}):s.jsx(m,{type:"info",showIcon:!0,message:"Pilih kelas untuk menampilkan rekap nilai akhir."}),k[89]=F,k[90]=V,k[91]=Y,k[92]=re,k[93]=U,k[94]=$,k[95]=Ge):Ge=k[95],k[96]!==qe||k[97]!==Ge?(He=s.jsxs(l,{vertical:!0,gap:16,children:[qe,Ge]}),k[96]=qe,k[97]=Ge,k[98]=He):He=k[98],He};function w(e,a){return{key:e.student_id,no:a+1,nis:e.nis||"-",full_name:e.full_name,final_grade:null===e.final_grade||void 0===e.final_grade?null:Number(e.final_grade)}}function S(e){return s.jsx(y,{strong:!0,children:e})}function v(e){return null==e?"-":s.jsx(u,{color:"blue",children:b(e)})}function I(e){return{value:e.id,label:e.full_name}}function N(e){return{value:e.id,label:e.name}}export{k as default};
